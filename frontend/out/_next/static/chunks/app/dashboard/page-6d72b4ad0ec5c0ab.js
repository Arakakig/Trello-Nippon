(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{67:function(){},2061:function(){},1386:function(e,t,s){Promise.resolve().then(s.bind(s,6949))},6949:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ex}});var a=s(7437),r=s(2265),l=s(4033),n=s(8958),i=s(4660),o=s(8222),d=s(5925);let c=(0,i.Ue)((e,t)=>({tasks:[],selectedTask:null,isLoading:!1,fetchTasks:async t=>{e({isLoading:!0});try{let s=await o.lC.getAll(t);e({tasks:s.data,isLoading:!1})}catch(t){console.error("Erro ao buscar tarefas:",t),d.default.error("Erro ao carregar tarefas"),e({isLoading:!1})}},createTask:async s=>{try{let a=await o.lC.create(s);e({tasks:[...t().tasks,a.data]}),d.default.success("Tarefa criada com sucesso!")}catch(e){throw console.error("Erro ao criar tarefa:",e),d.default.error("Erro ao criar tarefa"),e}},updateTask:async(s,a)=>{try{var r;let l=await o.lC.update(s,a),n=t().tasks.map(e=>e._id===s?l.data:e);e({tasks:n}),(null===(r=t().selectedTask)||void 0===r?void 0:r._id)===s&&e({selectedTask:l.data}),d.default.success("Tarefa atualizada!")}catch(e){throw console.error("Erro ao atualizar tarefa:",e),d.default.error("Erro ao atualizar tarefa"),e}},deleteTask:async s=>{try{await o.lC.delete(s);let a=t().tasks.filter(e=>e._id!==s);e({tasks:a,selectedTask:null}),d.default.success("Tarefa deletada!")}catch(e){throw console.error("Erro ao deletar tarefa:",e),d.default.error("Erro ao deletar tarefa"),e}},reorderTasks:async t=>{try{let s=await o.lC.reorder(t);e({tasks:s.data})}catch(e){throw console.error("Erro ao reordenar tarefas:",e),d.default.error("Erro ao reordenar tarefas"),e}},setSelectedTask:t=>{e({selectedTask:t})},uploadAttachment:async(s,a)=>{try{var r;let l=await o.lC.uploadAttachment(s,a),n=t().tasks.map(e=>e._id===s?l.data:e);e({tasks:n}),(null===(r=t().selectedTask)||void 0===r?void 0:r._id)===s&&e({selectedTask:l.data}),d.default.success("Arquivo enviado com sucesso!")}catch(e){throw console.error("Erro ao enviar arquivo:",e),d.default.error("Erro ao enviar arquivo"),e}},deleteAttachment:async(s,a)=>{try{var r;let l=await o.lC.deleteAttachment(s,a),n=t().tasks.map(e=>e._id===s?l.data:e);e({tasks:n}),(null===(r=t().selectedTask)||void 0===r?void 0:r._id)===s&&e({selectedTask:l.data}),d.default.success("Arquivo removido!")}catch(e){throw console.error("Erro ao remover arquivo:",e),d.default.error("Erro ao remover arquivo"),e}}})),m=(0,i.Ue)((e,t)=>({projects:[],selectedProject:null,isLoading:!1,fetchProjects:async()=>{e({isLoading:!0});try{let s=(await o.qx.getAll(!1)).data;if(e({projects:s,isLoading:!1}),!t().selectedProject&&s.length>0){let t=localStorage.getItem("selectedProjectId"),a=null;t&&(a=s.find(e=>e._id===t))&&console.log("\uD83D\uDD04 Restaurando projeto anterior:",a.name),a||(a=s.find(e=>e.isDefault)||s[0],console.log("\uD83D\uDCCB Selecionando projeto padr\xe3o:",null==a?void 0:a.name)),e({selectedProject:a})}}catch(t){console.error("Erro ao buscar projetos:",t),d.default.error("Erro ao carregar projetos"),e({isLoading:!1})}},createProject:async s=>{try{let a=await o.qx.create(s);return e({projects:[...t().projects,a.data]}),d.default.success("Projeto criado com sucesso!"),a.data}catch(e){throw console.error("Erro ao criar projeto:",e),d.default.error("Erro ao criar projeto"),e}},updateProject:async(s,a)=>{try{var r;let l=await o.qx.update(s,a),n=t().projects.map(e=>e._id===s?l.data:e);e({projects:n}),(null===(r=t().selectedProject)||void 0===r?void 0:r._id)===s&&e({selectedProject:l.data}),d.default.success("Projeto atualizado!")}catch(e){throw console.error("Erro ao atualizar projeto:",e),d.default.error("Erro ao atualizar projeto"),e}},deleteProject:async s=>{try{var a;await o.qx.delete(s);let r=t().projects.filter(e=>e._id!==s);e({projects:r}),(null===(a=t().selectedProject)||void 0===a?void 0:a._id)===s&&e({selectedProject:r[0]||null}),d.default.success("Projeto deletado!")}catch(e){throw console.error("Erro ao deletar projeto:",e),d.default.error("Erro ao deletar projeto"),e}},setSelectedProject:t=>{e({selectedProject:t}),t?(localStorage.setItem("selectedProjectId",t._id),console.log("\uD83D\uDCBE Projeto salvo no localStorage:",t.name)):localStorage.removeItem("selectedProjectId")},addMember:async(s,a,r)=>{var l,n,i;try{let n=await o.qx.addMember(s,a,r),i=t().projects.map(e=>e._id===s?n.data:e);e({projects:i}),(null===(l=t().selectedProject)||void 0===l?void 0:l._id)===s&&e({selectedProject:n.data}),d.default.success("Membro adicionado!")}catch(e){throw console.error("Erro ao adicionar membro:",e),d.default.error((null===(i=e.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.message)||"Erro ao adicionar membro"),e}},removeMember:async(s,a)=>{var r,l,n;try{let l=await o.qx.removeMember(s,a),n=t().projects.map(e=>e._id===s?l.data:e);e({projects:n}),(null===(r=t().selectedProject)||void 0===r?void 0:r._id)===s&&e({selectedProject:l.data}),d.default.success("Membro removido!")}catch(e){throw console.error("Erro ao remover membro:",e),d.default.error((null===(n=e.response)||void 0===n?void 0:null===(l=n.data)||void 0===l?void 0:l.message)||"Erro ao remover membro"),e}},updateMemberRole:async(s,a,r)=>{var l,n,i;try{let n=await o.qx.updateMemberRole(s,a,r),i=t().projects.map(e=>e._id===s?n.data:e);e({projects:i}),(null===(l=t().selectedProject)||void 0===l?void 0:l._id)===s&&e({selectedProject:n.data}),d.default.success("Permiss\xe3o atualizada!")}catch(e){throw console.error("Erro ao atualizar permiss\xe3o:",e),d.default.error((null===(i=e.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.message)||"Erro ao atualizar permiss\xe3o"),e}},createDefaultProject:async()=>{try{let s=await o.qx.createDefault();return t().projects.find(e=>e._id===s.data._id)||e({projects:[...t().projects,s.data]}),e({selectedProject:s.data}),s.data}catch(e){throw console.error("Erro ao criar projeto padr\xe3o:",e),e}}})),x=["\uD83D\uDCCB","\uD83D\uDE80","\uD83D\uDCBC","\uD83C\uDFAF","\uD83D\uDCCA","\uD83C\uDFA8","\uD83D\uDCA1","⚡","\uD83D\uDD25","⭐","\uD83C\uDF1F","\uD83C\uDF89"],u=[{name:"Azul",value:"#0ea5e9"},{name:"Verde",value:"#10b981"},{name:"Roxo",value:"#8b5cf6"},{name:"Rosa",value:"#ec4899"},{name:"Laranja",value:"#f97316"},{name:"Vermelho",value:"#ef4444"},{name:"Amarelo",value:"#f59e0b"},{name:"\xcdndigo",value:"#6366f1"}];function h(e){let{onClose:t,project:s}=e,{createProject:l,updateProject:n}=m(),[i,o]=(0,r.useState)((null==s?void 0:s.name)||""),[d,c]=(0,r.useState)((null==s?void 0:s.description)||""),[h,p]=(0,r.useState)((null==s?void 0:s.icon)||"\uD83D\uDCCB"),[g,j]=(0,r.useState)((null==s?void 0:s.color)||"#0ea5e9"),[y,v]=(0,r.useState)(!1),f=async e=>{if(e.preventDefault(),i.trim()){v(!0);try{s?await n(s._id,{name:i,description:d,icon:h,color:g}):await l({name:i,description:d,icon:h,color:g}),t()}catch(e){console.error("Erro ao salvar projeto:",e)}finally{v(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:s?"Editar Projeto":"Novo Projeto"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Projeto *"}),(0,a.jsx)("input",{id:"name",type:"text",required:!0,value:i,onChange:e=>o(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Ex: Desenvolvimento Web"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,a.jsx)("textarea",{id:"description",value:d,onChange:e=>c(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,placeholder:"Descreva o prop\xf3sito do projeto..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xcdcone"}),(0,a.jsx)("div",{className:"grid grid-cols-6 gap-2",children:x.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>p(e),className:"p-3 text-2xl rounded-md border-2 transition-colors ".concat(h===e?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"),children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2",children:u.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>j(e.value),className:"p-3 rounded-md border-2 transition-colors ".concat(g===e.value?"border-gray-900 ring-2 ring-offset-2 ring-gray-900":"border-gray-200"),style:{backgroundColor:e.value},title:e.name,children:g===e.value&&(0,a.jsx)("svg",{className:"w-5 h-5 text-white mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})},e.value))})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o:"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-2xl",style:{backgroundColor:g},children:h}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:i||"Nome do Projeto"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:d||"Descri\xe7\xe3o do projeto"})]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",disabled:y,className:"flex-1 bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Salvando...":s?"Salvar":"Criar Projeto"}),(0,a.jsx)("button",{type:"button",onClick:t,className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300",children:"Cancelar"})]})]})]})})}let p={owner:"Dono",admin:"Administrador",member:"Editor",viewer:"Leitor"},g={admin:"Pode gerenciar membros e todas as tarefas",member:"Pode criar e editar tarefas",viewer:"Pode apenas visualizar tarefas"};function j(e){var t,s,l,n;let{onClose:i}=e,{selectedProject:c,addMember:x,removeMember:u,updateMemberRole:j,deleteProject:y}=m(),[v,f]=(0,r.useState)([]),[b,N]=(0,r.useState)(""),[w,C]=(0,r.useState)("member"),[k,D]=(0,r.useState)(!1),[L,S]=(0,r.useState)(!1),[E,P]=(0,r.useState)("");(0,r.useEffect)(()=>{M()},[]);let M=async()=>{try{let e=await o.iJ.getUsers();f(e.data)}catch(e){console.error("Erro ao buscar usu\xe1rios:",e)}},V=async()=>{if(b.trim()&&c){S(!0),P("");try{let e=await o.iJ.getUserByEmail(b.trim());if(!e.data.found){P("Nenhum usu\xe1rio encontrado com este email. A pessoa precisa criar uma conta primeiro."),S(!1);return}let t=e.data.user;if(c.members.some(e=>e.user.id===t.id)){P("Este usu\xe1rio j\xe1 \xe9 membro do projeto."),S(!1);return}await x(c._id,t.id,w),N(""),C("member"),P(""),d.default.success("".concat(t.name," foi adicionado ao projeto!"))}catch(t){var e;console.error("Erro ao adicionar membro:",t),(null===(e=t.response)||void 0===e?void 0:e.status)===404?P("Nenhum usu\xe1rio encontrado com este email. A pessoa precisa criar uma conta primeiro."):P("Erro ao buscar usu\xe1rio. Tente novamente.")}finally{S(!1)}}},A=async e=>{if(c&&confirm("Tem certeza que deseja remover este membro?"))try{await u(c._id,e)}catch(e){console.error("Erro ao remover membro:",e)}},T=async(e,t)=>{if(c)try{await j(c._id,e,t)}catch(e){console.error("Erro ao atualizar permiss\xe3o:",e)}},_=async()=>{if(c&&confirm('Tem certeza que deseja deletar o projeto "'.concat(c.name,'"? Todas as tarefas ser\xe3o removidas permanentemente!')))try{await y(c._id),i(),d.default.success("Projeto deletado com sucesso")}catch(e){console.error("Erro ao deletar projeto:",e)}};if(!c)return null;v.filter(e=>!c.members.some(t=>{var s;return(null===(s=t.user)||void 0===s?void 0:s.id)===e.id}));let B=null;try{let e=localStorage.getItem("user");e&&(B=JSON.parse(e).id)}catch(e){console.error("Erro ao obter user do localStorage:",e)}let I=String((null===(t=c.owner)||void 0===t?void 0:t.id)||(null===(s=c.owner)||void 0===s?void 0:s.id)||c.owner)===String(B),z=c.members.some(e=>{var t,s;let a=(null===(t=e.user)||void 0===t?void 0:t.id)||(null===(s=e.user)||void 0===s?void 0:s.id);return"owner"===e.role&&String(a)===String(B)}),F=I||z,R=c.members.some(e=>{var t,s;let a=(null===(t=e.user)||void 0===t?void 0:t.id)||(null===(s=e.user)||void 0===s?void 0:s.id);return"admin"===e.role&&String(a)===String(B)});return console.log("Debug ProjectSettings:",{currentUserId:B,ownerId:(null===(l=c.owner)||void 0===l?void 0:l.id)||(null===(n=c.owner)||void 0===n?void 0:n.id),isOwner:F,isAdmin:R,canManageMembers:!0,members:c.members}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-2xl",style:{backgroundColor:c.color},children:c.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:c.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:c.description})]})]}),(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"A\xe7\xf5es do Projeto"}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>D(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Editar Projeto"}),F&&(0,a.jsx)("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Deletar Projeto"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:["Membros (",c.members.length,")"]}),(0,a.jsx)("div",{className:"space-y-2 mb-4",children:c.members.map(e=>{var t,s;return e.user&&e.user.name?(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary-500 text-white flex items-center justify-center",children:(null===(s=e.user.name)||void 0===s?void 0:null===(t=s.charAt(0))||void 0===t?void 0:t.toUpperCase())||"?"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.user.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.user.email})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:"owner"===e.role?(0,a.jsx)("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium",children:p[e.role]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("select",{value:e.role,onChange:t=>T(e.user.id,t.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",disabled:!1,title:g[e.role]||"",children:[(0,a.jsx)("option",{value:"admin",children:"⚙️ Administrador"}),(0,a.jsx)("option",{value:"member",children:"\uD83D\uDCDD Editor"}),(0,a.jsx)("option",{value:"viewer",children:"\uD83D\uDC41️ Leitor"})]}),(0,a.jsx)("button",{onClick:()=>A(e.user.id),className:"text-red-600 hover:text-red-800",title:"Remover membro",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]},e.user.id||e._id):null})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDD17 Compartilhar Projeto"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"Digite o email da pessoa que deseja adicionar. Ela precisar\xe1 ter uma conta no sistema."}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"email",value:b,onChange:e=>{N(e.target.value),P("")},onKeyPress:e=>{"Enter"===e.key&&V()},placeholder:"email@exemplo.com",className:"flex-1 border border-gray-300 rounded-md p-2 text-sm"}),(0,a.jsxs)("select",{value:w,onChange:e=>C(e.target.value),className:"border border-gray-300 rounded-md p-2 text-sm",title:g[w],children:[(0,a.jsx)("option",{value:"member",children:"\uD83D\uDCDD Editor"}),(0,a.jsx)("option",{value:"admin",children:"⚙️ Administrador"}),(0,a.jsx)("option",{value:"viewer",children:"\uD83D\uDC41️ Leitor"})]}),(0,a.jsx)("button",{onClick:V,disabled:!b.trim()||L,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-1",children:L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,a.jsx)("span",{children:"Buscando..."})]}):(0,a.jsx)("span",{children:"Adicionar"})})]}),E&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-md text-sm",children:E}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 text-xs",children:[(0,a.jsx)("p",{className:"font-semibold text-blue-900 mb-2",children:"N\xedveis de Permiss\xe3o:"}),(0,a.jsxs)("ul",{className:"space-y-1 text-blue-800",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDCDD Editor:"})," Pode criar e editar tarefas"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"⚙️ Administrador:"})," Pode gerenciar membros e todas as tarefas"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDC41️ Leitor:"})," Pode apenas visualizar tarefas (sem edi\xe7\xe3o)"]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4 text-sm text-gray-500",children:[(0,a.jsxs)("p",{children:["Projeto criado em ",new Date(c.createdAt).toLocaleDateString("pt-BR")]}),(0,a.jsx)("p",{className:"mt-1",children:(0,a.jsx)("strong",{children:"N\xedveis de Permiss\xe3o:"})}),(0,a.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDC51 Dono:"})," Controle total do projeto (criar, editar, deletar, gerenciar membros)"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"⚙️ Administrador:"})," Pode gerenciar membros e todas as tarefas"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDCDD Editor:"})," Pode criar e editar tarefas do projeto"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDC41️ Leitor:"})," Pode apenas visualizar tarefas (sem permiss\xe3o de edi\xe7\xe3o)"]})]}),(0,a.jsxs)("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800",children:[(0,a.jsx)("strong",{children:"\uD83D\uDCA1 Dica:"})," Para compartilhar este projeto, adicione pessoas usando o email delas. Elas precisam ter uma conta criada no sistema."]})]})]})]})}),k&&(0,a.jsx)(h,{onClose:()=>D(!1),project:c})]})}function y(){let{user:e,logout:t}=(0,n.t)(),{selectedProject:s}=m(),i=(0,l.useRouter)(),[o,d]=(0,r.useState)(!1);return(0,a.jsxs)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("h1",{className:"text-2xl font-bold text-primary-600",children:"Trello Nippon"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[s&&(0,a.jsxs)("button",{onClick:()=>d(!0),className:"text-sm text-gray-600 hover:text-gray-900 font-medium flex items-center space-x-1",children:[(0,a.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,a.jsx)("span",{children:"Configura\xe7\xf5es"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center text-white font-semibold",children:null==e?void 0:e.name.charAt(0).toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:null==e?void 0:e.name})]}),(0,a.jsx)("button",{onClick:()=>{t(),i.push("/login")},className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"Sair"})]})]})}),o&&(0,a.jsx)(j,{onClose:()=>d(!1)})]})}var v=s(9684),f=s(7369),b=s(7344),N=s(2836);let w={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"},C={low:"Baixa",medium:"M\xe9dia",high:"Alta"};function k(e){let{task:t}=e,{setSelectedTask:s}=c(),{attributes:r,listeners:l,setNodeRef:n,transform:i}=(0,v.O1)({id:t._id}),o=i?{transform:"translate3d(".concat(i.x,"px, ").concat(i.y,"px, 0)")}:void 0;return(0,a.jsxs)("div",{ref:n,style:o,...l,...r,onClick:()=>{s(t)},className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow cursor-pointer",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:t.title}),t.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(w[t.priority]),children:C[t.priority]}),t.dueDate&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:(0,b.WU)(new Date(t.dueDate),"dd/MM/yyyy",{locale:N.F})})]}),t.assignedTo.length>0&&(0,a.jsxs)("div",{className:"flex items-center mt-3 space-x-1",children:[t.assignedTo.slice(0,3).map(e=>(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary-500 text-white text-xs flex items-center justify-center",title:e.name,children:e.name.charAt(0).toUpperCase()},e.id)),t.assignedTo.length>3&&(0,a.jsxs)("div",{className:"w-6 h-6 rounded-full bg-gray-300 text-gray-700 text-xs flex items-center justify-center",children:["+",t.assignedTo.length-3]})]}),t.attachments.length>0&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500 flex items-center",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),t.attachments.length," anexo",t.attachments.length>1?"s":""]})]})}function D(e){let{id:t,title:s,color:r,tasks:l}=e,{setNodeRef:n}=(0,v.Zj)({id:t});return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"".concat(r," rounded-t-lg p-3 border-b-2 border-gray-300"),children:(0,a.jsxs)("h3",{className:"font-semibold text-gray-800 flex items-center justify-between",children:[s,(0,a.jsx)("span",{className:"text-xs bg-white px-2 py-1 rounded-full",children:l.length})]})}),(0,a.jsxs)("div",{ref:n,className:"flex-1 bg-gray-50 rounded-b-lg p-3 min-h-[500px] space-y-3 overflow-y-auto scrollbar-hide",children:[(0,a.jsx)(f.Fo,{items:l.map(e=>e._id),strategy:f.qw,children:l.map(e=>(0,a.jsx)(k,{task:e},e._id))}),0===l.length&&(0,a.jsx)("div",{className:"text-center text-gray-400 text-sm mt-8",children:"Arraste tarefas aqui"})]})]})}let L=[{id:"todo",title:"A Fazer",color:"bg-gray-100"},{id:"in_progress",title:"Em Progresso",color:"bg-blue-100"},{id:"review",title:"Em Revis\xe3o",color:"bg-yellow-100"},{id:"done",title:"Conclu\xeddo",color:"bg-green-100"}];function S(){let{tasks:e,fetchTasks:t,reorderTasks:s}=c(),{selectedProject:l}=m(),[n,i]=(0,r.useState)(null),o=(0,v.Dy)((0,v.VT)(v.we,{activationConstraint:{distance:8}}));return(0,r.useEffect)(()=>{l&&t(l._id)},[l,t]),(0,a.jsxs)(v.LB,{sensors:o,onDragStart:t=>{i(e.find(e=>e._id===t.active.id)||null)},onDragEnd:t=>{let{active:a,over:r}=t;if(i(null),!r)return;let l=a.id,n=r.id,o=e.find(e=>e._id===l);if(!o||o.status===n)return;let d=e.filter(e=>e.status===n&&e._id!==l);s([...e.filter(e=>e.status!==n&&e._id!==l),...d,{...o,status:n}].map((e,t)=>({id:e._id,status:e._id===l?n:e.status,order:t})))},children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-6",children:L.map(t=>(0,a.jsx)(D,{id:t.id,title:t.title,color:t.color,tasks:e.filter(e=>e.status===t.id)},t.id))}),(0,a.jsx)(v.y9,{children:n?(0,a.jsx)("div",{className:"opacity-80",children:(0,a.jsx)(k,{task:n})}):null})]})}var E=s(3158);s(9865);var P=s(2339);function M(){let{tasks:e,fetchTasks:t,setSelectedTask:s}=c(),{selectedProject:l}=m(),[n,i]=(0,r.useState)(new Date),[o,d]=(0,r.useState)([]);(0,r.useEffect)(()=>{l&&t(l._id)},[l,t]),(0,r.useEffect)(()=>{d(e.filter(e=>e.dueDate&&(0,P.K)(new Date(e.dueDate),n)))},[n,e]);let x={low:"border-green-500",medium:"border-yellow-500",high:"border-red-500"},u={todo:"A Fazer",in_progress:"Em Progresso",review:"Em Revis\xe3o",done:"Conclu\xeddo"};return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Calend\xe1rio de Tarefas"}),(0,a.jsx)(E.ZP,{onChange:e=>i(e),value:n,locale:"pt-BR",tileContent:t=>{let{date:s,view:r}=t;return"month"===r&&e.filter(e=>e.dueDate&&(0,P.K)(new Date(e.dueDate),s)).length>0?(0,a.jsx)("div",{className:"flex justify-center mt-1",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-primary-500 rounded-full"})}):null},className:"w-full"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Tarefas para ",(0,b.WU)(n,"dd 'de' MMMM 'de' yyyy",{locale:N.F})]}),0===o.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Nenhuma tarefa agendada para esta data"}):(0,a.jsx)("div",{className:"space-y-3",children:o.map(e=>(0,a.jsx)("div",{onClick:()=>s(e),className:"border-l-4 ".concat(x[e.priority]," bg-gray-50 p-4 rounded-r-lg cursor-pointer hover:bg-gray-100 transition-colors"),children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.title}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center mt-2 space-x-3",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Status: ",u[e.status]]}),e.assignedTo.length>0&&(0,a.jsx)("div",{className:"flex items-center space-x-1",children:e.assignedTo.slice(0,2).map(e=>(0,a.jsx)("div",{className:"w-5 h-5 rounded-full bg-primary-500 text-white text-xs flex items-center justify-center",title:e.name,children:e.name.charAt(0).toUpperCase()},e.id))})]})]})})},e._id))})]})]})})}var V=s(5020);function A(e){let{task:t}=e,{uploadAttachment:s,deleteAttachment:l}=c(),[n,i]=(0,r.useState)(!1),[o,m]=(0,r.useState)(null),x=async e=>{if(0===e.length)return;let a=e[0];if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp","application/pdf"].includes(a.type)){d.default.error("Tipo de arquivo n\xe3o permitido. Apenas imagens e PDFs s\xe3o aceitos.");return}if(a.size>10485760){d.default.error("Arquivo muito grande. Tamanho m\xe1ximo: 10MB");return}i(!0);try{await s(t._id,a)}catch(e){console.error("Erro ao fazer upload:",e)}finally{i(!1)}},{getRootProps:u,getInputProps:h,isDragActive:p}=(0,V.uI)({onDrop:x,accept:{"image/*":[".jpeg",".jpg",".png",".gif",".webp"],"application/pdf":[".pdf"]},maxFiles:1}),g=async e=>{if(confirm("Tem certeza que deseja remover este anexo?"))try{await l(t._id,e)}catch(e){console.error("Erro ao deletar anexo:",e)}},j=e=>{let t="".concat("https://trello-nippon.onrender.com/api".replace("/api",""),"/").concat(e.path);e.mimetype.startsWith("image/")?m(t):"application/pdf"===e.mimetype&&window.open(t,"_blank")},y=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(2)+" KB":(e/1048576).toFixed(2)+" MB";return(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Anexos"}),(0,a.jsxs)("div",{...u(),className:"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ".concat(p?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-primary-400"," ").concat(n?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)("input",{...h(),disabled:n}),n?(0,a.jsx)("p",{className:"text-gray-600",children:"Enviando arquivo..."}):p?(0,a.jsx)("p",{className:"text-primary-600",children:"Solte o arquivo aqui..."}):(0,a.jsxs)("div",{children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Arraste e solte um arquivo aqui, ou clique para selecionar"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Imagens (JPEG, PNG, GIF, WebP) ou PDFs at\xe9 10MB"})]})]}),t.attachments.length>0&&(0,a.jsx)("div",{className:"mt-4 space-y-2",children:t.attachments.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3 hover:bg-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.mimetype.startsWith("image/")?(0,a.jsx)("svg",{className:"w-8 h-8 text-blue-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}):(0,a.jsx)("svg",{className:"w-8 h-8 text-red-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.originalName}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[y(e.size)," • ",e.uploadedBy.name]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 ml-2",children:[(0,a.jsx)("button",{onClick:()=>j(e),className:"text-primary-600 hover:text-primary-800 text-sm font-medium",children:"Ver"}),(0,a.jsx)("button",{onClick:()=>g(e._id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remover"})]})]},e._id))}),o&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:()=>m(null),children:(0,a.jsxs)("div",{className:"relative max-w-4xl max-h-full",children:[(0,a.jsx)("button",{onClick:()=>m(null),className:"absolute -top-10 right-0 text-white hover:text-gray-300",children:(0,a.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("img",{src:o,alt:"Preview",className:"max-w-full max-h-[80vh] object-contain"})]})})]})}let T=[{value:"todo",label:"A Fazer"},{value:"in_progress",label:"Em Progresso"},{value:"review",label:"Em Revis\xe3o"},{value:"done",label:"Conclu\xeddo"}],_=[{value:"low",label:"Baixa"},{value:"medium",label:"M\xe9dia"},{value:"high",label:"Alta"}];function B(){var e,t;let{selectedTask:s,setSelectedTask:l,updateTask:n,deleteTask:i}=c(),[m,x]=(0,r.useState)([]),[u,h]=(0,r.useState)(""),[p,g]=(0,r.useState)([]),[j,y]=(0,r.useState)(!1),[v,f]=(0,r.useState)(s);(0,r.useEffect)(()=>{s&&(f(s),w(),C())},[s]);let w=async()=>{if(s)try{let e=await o.HF.getByTask(s._id);x(e.data)}catch(e){console.error("Erro ao buscar coment\xe1rios:",e)}},C=async()=>{try{let e=await o.iJ.getUsers();g(e.data)}catch(e){console.error("Erro ao buscar usu\xe1rios:",e)}},k=async e=>{if(e.preventDefault(),u.trim()&&s)try{let e=await o.HF.create({taskId:s._id,text:u});x([e.data,...m]),h("")}catch(e){console.error("Erro ao adicionar coment\xe1rio:",e)}},D=async e=>{try{await o.HF.delete(e),x(m.filter(t=>t._id!==e)),d.default.success("Coment\xe1rio removido!")}catch(e){console.error("Erro ao deletar coment\xe1rio:",e)}},L=async()=>{if(s&&v)try{await n(s._id,{title:v.title,description:v.description,status:v.status,priority:v.priority,dueDate:v.dueDate,assignedTo:v.assignedTo.map(e=>e.id)}),y(!1)}catch(e){console.error("Erro ao salvar tarefa:",e)}},S=async()=>{if(s&&confirm("Tem certeza que deseja deletar esta tarefa?"))try{await i(s._id),l(null)}catch(e){console.error("Erro ao deletar tarefa:",e)}},E=e=>{if(!v)return;let t=v.assignedTo.some(t=>t.id===e.id)?v.assignedTo.filter(t=>t.id!==e.id):[...v.assignedTo,e];f({...v,assignedTo:t})};return s&&v?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-start",children:[(0,a.jsx)("div",{className:"flex-1",children:j?(0,a.jsx)("input",{type:"text",value:v.title,onChange:e=>f({...v,title:e.target.value}),className:"text-2xl font-bold w-full border-b-2 border-primary-500 focus:outline-none"}):(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:s.title})}),(0,a.jsx)("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600 ml-4",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:L,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Salvar"}),(0,a.jsx)("button",{onClick:()=>{y(!1),f(s)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancelar"})]}):(0,a.jsx)("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Editar"}),(0,a.jsx)("button",{onClick:S,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Deletar"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Descri\xe7\xe3o"}),j?(0,a.jsx)("textarea",{value:v.description,onChange:e=>f({...v,description:e.target.value}),className:"w-full border border-gray-300 rounded-md p-3 min-h-[100px] focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Adicione uma descri\xe7\xe3o..."}):(0,a.jsx)("p",{className:"text-gray-600",children:s.description||"Sem descri\xe7\xe3o"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Status"}),j?(0,a.jsx)("select",{value:v.status,onChange:e=>f({...v,status:e.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:T.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,a.jsx)("p",{className:"text-gray-600",children:null===(e=T.find(e=>e.value===s.status))||void 0===e?void 0:e.label})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Prioridade"}),j?(0,a.jsx)("select",{value:v.priority,onChange:e=>f({...v,priority:e.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:_.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,a.jsx)("p",{className:"text-gray-600",children:null===(t=_.find(e=>e.value===s.priority))||void 0===t?void 0:t.label})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Data de Vencimento"}),j?(0,a.jsx)("input",{type:"date",value:v.dueDate?v.dueDate.split("T")[0]:"",onChange:e=>f({...v,dueDate:e.target.value||null}),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500"}):(0,a.jsx)("p",{className:"text-gray-600",children:s.dueDate?(0,b.WU)(new Date(s.dueDate),"dd 'de' MMMM 'de' yyyy",{locale:N.F}):"Sem data de vencimento"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Atribu\xeddo a"}),j?(0,a.jsx)("div",{className:"space-y-2",children:p.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:v.assignedTo.some(t=>t.id===e.id),onChange:()=>E(e),className:"rounded text-primary-600 focus:ring-primary-500"}),(0,a.jsx)("span",{className:"text-gray-700",children:e.name})]},e.id))}):(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:s.assignedTo.length>0?s.assignedTo.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-primary-100 text-primary-800 px-3 py-1 rounded-full",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary-500 text-white text-xs flex items-center justify-center",children:e.name.charAt(0).toUpperCase()}),(0,a.jsx)("span",{className:"text-sm",children:e.name})]},e.id)):(0,a.jsx)("p",{className:"text-gray-500",children:"Nenhum usu\xe1rio atribu\xeddo"})})]}),(0,a.jsx)(A,{task:s}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Coment\xe1rios"}),(0,a.jsxs)("form",{onSubmit:k,className:"mb-4",children:[(0,a.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),className:"w-full border border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Adicione um coment\xe1rio...",rows:3}),(0,a.jsx)("button",{type:"submit",disabled:!u.trim(),className:"mt-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Comentar"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[m.map(e=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-500 text-white text-sm flex items-center justify-center",children:e.user.name.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:e.user.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(0,b.WU)(new Date(e.createdAt),"dd/MM/yyyy '\xe0s' HH:mm",{locale:N.F})})]})]}),(0,a.jsx)("button",{onClick:()=>D(e._id),className:"text-red-500 hover:text-red-700 text-sm",children:"Remover"})]}),(0,a.jsx)("p",{className:"mt-2 text-gray-700",children:e.text})]},e._id)),0===m.length&&(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhum coment\xe1rio ainda"})]})]})]})]})}):null}function I(e){let{onClose:t}=e,{createTask:s}=c(),{selectedProject:l}=m(),[n,i]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[x,u]=(0,r.useState)("medium"),[h,p]=(0,r.useState)(""),[g,j]=(0,r.useState)(!1),[y,v]=(0,r.useState)(!1),[f,b]=(0,r.useState)("weekly"),[N,w]=(0,r.useState)([]),[C,k]=(0,r.useState)(""),D=e=>{w(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},L=async e=>{if(e.preventDefault(),n.trim()){if(!l){alert("Selecione um projeto primeiro");return}j(!0);try{await s({title:n,description:o,priority:x,dueDate:h||null,status:"todo",projectId:l._id,isRecurring:y,recurringType:y?f:null,recurringDays:y?N:[],recurringEndDate:y&&C?C:null}),t()}catch(e){console.error("Erro ao criar tarefa:",e)}finally{j(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-6 pb-4 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Nova Tarefa"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,a.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo *"}),(0,a.jsx)("input",{id:"title",type:"text",required:!0,value:n,onChange:e=>i(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Digite o t\xedtulo da tarefa"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,a.jsx)("textarea",{id:"description",value:o,onChange:e=>d(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,placeholder:"Descreva a tarefa..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridade"}),(0,a.jsxs)("select",{id:"priority",value:x,onChange:e=>u(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"low",children:"Baixa"}),(0,a.jsx)("option",{value:"medium",children:"M\xe9dia"}),(0,a.jsx)("option",{value:"high",children:"Alta"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Vencimento"}),(0,a.jsx)("input",{id:"dueDate",type:"date",value:h,onChange:e=>p(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,a.jsx)("input",{type:"checkbox",id:"isRecurring",checked:y,onChange:e=>v(e.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,a.jsx)("label",{htmlFor:"isRecurring",className:"text-sm font-medium text-gray-700",children:"Tarefa Recorrente"})]}),y&&(0,a.jsxs)("div",{className:"space-y-4 pl-6 border-l-2 border-primary-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Recorr\xeancia"}),(0,a.jsxs)("select",{value:f,onChange:e=>b(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"weekly",children:"Semanal"}),(0,a.jsx)("option",{value:"monthly",children:"Mensal"}),(0,a.jsx)("option",{value:"yearly",children:"Anual"})]})]}),"weekly"===f&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dias da Semana"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{value:0,label:"Domingo"},{value:1,label:"Segunda"},{value:2,label:"Ter\xe7a"},{value:3,label:"Quarta"},{value:4,label:"Quinta"},{value:5,label:"Sexta"},{value:6,label:"S\xe1bado"}].map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:N.includes(e.value),onChange:()=>D(e.value),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:e.label})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"recurringEndDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de T\xe9rmino (opcional)"}),(0,a.jsx)("input",{id:"recurringEndDate",type:"date",value:C,onChange:e=>k(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]})]})}),(0,a.jsx)("div",{className:"border-t border-gray-200 p-6 pt-4",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{type:"submit",disabled:g,onClick:L,className:"flex-1 bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Criando...":"Criar Tarefa"}),(0,a.jsx)("button",{type:"button",onClick:t,className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300",children:"Cancelar"})]})})]})})}function z(){let{projects:e,selectedProject:t,setSelectedProject:s,fetchProjects:l}=m(),[n,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l()},[l]);let c=e=>{s(e),i(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>i(!n),className:"flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:(null==t?void 0:t.icon)||"\uD83D\uDCCB"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:(null==t?void 0:t.name)||"Selecione um projeto"}),t&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[t.members.length," membro",1!==t.members.length?"s":""]})]}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-500 transition-transform ".concat(n?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),(0,a.jsx)("div",{className:"absolute top-full left-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:(0,a.jsxs)("div",{className:"p-2 max-h-96 overflow-y-auto",children:[(0,a.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase",children:"Seus Projetos"}),0===e.length?(0,a.jsx)("div",{className:"px-3 py-6 text-center text-gray-500 text-sm",children:"Nenhum projeto encontrado"}):e.map(e=>(0,a.jsxs)("button",{onClick:()=>c(e),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-md hover:bg-gray-100 transition-colors ".concat((null==t?void 0:t._id)===e._id?"bg-primary-50":""),children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.description})]}),(null==t?void 0:t._id)===e._id&&(0,a.jsx)("svg",{className:"w-5 h-5 text-primary-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},e._id)),(0,a.jsx)("div",{className:"border-t border-gray-200 mt-2 pt-2",children:(0,a.jsxs)("button",{onClick:()=>{d(!0),i(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-primary-600 hover:bg-primary-50 rounded-md transition-colors",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsx)("span",{className:"font-medium",children:"Novo Projeto"})]})})]})})]})]}),o&&(0,a.jsx)(h,{onClose:()=>d(!1)})]})}function F(){let{user:e}=(0,n.t)(),[t,s]=(0,r.useState)(!1),[l,i]=(0,r.useState)(!1),c=async()=>{i(!0);try{await o.iJ.resendVerification(),d.default.success("Email de verifica\xe7\xe3o reenviado! Verifique sua caixa de entrada.",{duration:5e3})}catch(s){var e,t;d.default.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Erro ao reenviar email")}finally{i(!1)}};return!e||e.emailVerified||t?null:(0,a.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,a.jsx)("strong",{children:"⚠️ Email n\xe3o verificado."})," Verifique seu email para ativar sua conta e ter acesso completo."]}),(0,a.jsxs)("div",{className:"mt-2 flex space-x-3",children:[(0,a.jsx)("button",{onClick:c,disabled:l,className:"text-sm font-medium text-yellow-800 underline hover:text-yellow-900 disabled:opacity-50",children:l?"Reenviando...":"Reenviar email de verifica\xe7\xe3o"}),(0,a.jsx)("button",{onClick:()=>s(!0),className:"text-sm font-medium text-yellow-600 hover:text-yellow-700",children:"Dispensar"})]})]})]})})}let R=(0,i.Ue)((e,t)=>({clients:[],selectedClient:null,isLoading:!1,fetchClients:async(t,s)=>{e({isLoading:!0});try{let a={};t&&(a.projectId=t),(null==s?void 0:s.startDate)&&(a.startDate=s.startDate),(null==s?void 0:s.endDate)&&(a.endDate=s.endDate);let r=await o.ZP.get("/clients",{params:a});e({clients:r.data,isLoading:!1})}catch(t){console.error("Erro ao buscar clientes:",t),e({isLoading:!1})}},createClient:async t=>{e({isLoading:!0});try{let s=(await o.ZP.post("/clients",t)).data;return e(e=>({clients:[s,...e.clients],isLoading:!1})),s}catch(t){throw console.error("Erro ao criar cliente:",t),e({isLoading:!1}),t}},updateClient:async(t,s)=>{e({isLoading:!0});try{let a=(await o.ZP.put("/clients/".concat(t),s)).data;return e(e=>{var s;return{clients:e.clients.map(e=>e._id===t?a:e),selectedClient:(null===(s=e.selectedClient)||void 0===s?void 0:s._id)===t?a:e.selectedClient,isLoading:!1}}),a}catch(t){throw console.error("Erro ao atualizar cliente:",t),e({isLoading:!1}),t}},deleteClient:async t=>{e({isLoading:!0});try{await o.ZP.delete("/clients/".concat(t)),e(e=>{var s;return{clients:e.clients.filter(e=>e._id!==t),selectedClient:(null===(s=e.selectedClient)||void 0===s?void 0:s._id)===t?null:e.selectedClient,isLoading:!1}})}catch(t){throw console.error("Erro ao deletar cliente:",t),e({isLoading:!1}),t}},setSelectedClient:t=>{e({selectedClient:t})}})),O=(0,i.Ue)((e,t)=>({vendors:[],selectedVendor:null,isLoading:!1,fetchVendors:async()=>{e({isLoading:!0});try{let t=await o.ZP.get("/vendors");e({vendors:t.data,isLoading:!1})}catch(t){console.error("Erro ao buscar vendedores:",t),e({isLoading:!1})}},createVendor:async t=>{e({isLoading:!0});try{let s=(await o.ZP.post("/vendors",t)).data;return e(e=>({vendors:[...e.vendors,s].sort((e,t)=>e.name.localeCompare(t.name)),isLoading:!1})),s}catch(t){throw console.error("Erro ao criar vendedor:",t),e({isLoading:!1}),t}},updateVendor:async(t,s)=>{e({isLoading:!0});try{let a=(await o.ZP.put("/vendors/".concat(t),s)).data;return e(e=>{var s;return{vendors:e.vendors.map(e=>e._id===t?a:e).sort((e,t)=>e.name.localeCompare(t.name)),selectedVendor:(null===(s=e.selectedVendor)||void 0===s?void 0:s._id)===t?a:e.selectedVendor,isLoading:!1}}),a}catch(t){throw console.error("Erro ao atualizar vendedor:",t),e({isLoading:!1}),t}},deleteVendor:async t=>{e({isLoading:!0});try{await o.ZP.delete("/vendors/".concat(t)),e(e=>{var s;return{vendors:e.vendors.filter(e=>e._id!==t),selectedVendor:(null===(s=e.selectedVendor)||void 0===s?void 0:s._id)===t?null:e.selectedVendor,isLoading:!1}})}catch(t){throw console.error("Erro ao deletar vendedor:",t),e({isLoading:!1}),t}},setSelectedVendor:t=>{e({selectedVendor:t})},linkVendorsToUsers:async()=>{e({isLoading:!0});try{let e=await o.ZP.post("/vendors/link-users");return await t().fetchVendors(),e.data}catch(t){throw console.error("Erro ao vincular vendedores:",t),e({isLoading:!1}),t}}}));function W(e){let{onClose:t,client:s,isEditing:l=!1}=e,{createClient:n,updateClient:i}=R(),{selectedProject:o}=m(),{vendors:d,fetchVendors:c}=O(),[x,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)({});(0,r.useEffect)(()=>{c()},[c]);let[g,j]=(0,r.useState)({name:(null==s?void 0:s.name)||"",phone:(null==s?void 0:s.phone)||"",contract:(null==s?void 0:s.contract)||"",adhesionDate:(null==s?void 0:s.adhesionDate)?s.adhesionDate.split("T")[0]:"",contractDate:(null==s?void 0:s.contractDate)?s.contractDate.split("T")[0]:"",dueDate:(null==s?void 0:s.dueDate)?s.dueDate.split("T")[0]:"",plan:(null==s?void 0:s.plan)||"",observation:(null==s?void 0:s.observation)||"",adhesionValue:(null==s?void 0:s.adhesionValue)||0,paymentMethod:(null==s?void 0:s.paymentMethod)||"",confirmation:(null==s?void 0:s.confirmation)||"",homeVisit:(null==s?void 0:s.homeVisit)||!1,origin:(null==s?void 0:s.origin)||"",paid:(null==s?void 0:s.paid)||!1,vendor:(null==s?void 0:s.vendor)?"string"==typeof s.vendor?s.vendor:s.vendor._id:"",listMonth:(null==s?void 0:s.listMonth)||new Date().toLocaleDateString("pt-BR",{month:"long"}),listYear:(null==s?void 0:s.listYear)||new Date().getFullYear()}),y=e=>{let{name:t,value:s,type:a}=e.target;if("checkbox"===a){let s=e.target.checked;j(e=>({...e,[t]:s}))}else j(e=>({...e,[t]:s}));h[t]&&p(e=>({...e,[t]:""}))},v=()=>{let e={};return g.adhesionValue&&g.adhesionValue<0&&(e.adhesionValue="Valor da Ades\xe3o deve ser maior ou igual a zero"),p(e),0===Object.keys(e).length},f=async e=>{if(e.preventDefault(),v()){if(!o){p({project:"Nenhum projeto selecionado"});return}u(!0);try{let e={...g,projectId:o._id,adhesionValue:parseFloat(g.adhesionValue.toString()),vendor:g.vendor||null};l&&s?await i(s._id,e):await n(e),t()}catch(e){console.error("Erro ao salvar cliente:",e)}finally{u(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:l?"Editar Cliente":"Novo Cliente"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),(0,a.jsx)("input",{type:"text",name:"name",value:g.name,onChange:y,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.name?"border-red-500":"border-gray-300"),placeholder:"Nome completo"}),h.name&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone *"}),(0,a.jsx)("input",{type:"tel",name:"phone",value:g.phone,onChange:y,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.phone?"border-red-500":"border-gray-300"),placeholder:"(11) 99999-9999"}),h.phone&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrato"}),(0,a.jsx)("input",{type:"text",name:"contract",value:g.contract,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.contract?"border-red-500":"border-gray-300"),placeholder:"N\xfamero do contrato"}),h.contract&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.contract})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Ades\xe3o"}),(0,a.jsx)("input",{type:"date",name:"adhesionDate",value:g.adhesionDate,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.adhesionDate?"border-red-500":"border-gray-300")}),h.adhesionDate&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.adhesionDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Contrato"}),(0,a.jsx)("input",{type:"date",name:"contractDate",value:g.contractDate,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.contractDate?"border-red-500":"border-gray-300")}),h.contractDate&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.contractDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Vencimento"}),(0,a.jsx)("input",{type:"date",name:"dueDate",value:g.dueDate,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.dueDate?"border-red-500":"border-gray-300")}),h.dueDate&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.dueDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plano"}),(0,a.jsxs)("select",{name:"plan",value:g.plan,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.plan?"border-red-500":"border-gray-300"),children:[(0,a.jsx)("option",{value:"",children:"Selecione o plano..."}),(0,a.jsx)("option",{value:"1GAVETA",children:"1GAVETA"}),(0,a.jsx)("option",{value:"2GAVETAS",children:"2GAVETAS"}),(0,a.jsx)("option",{value:"3GAVETAS",children:"3GAVETAS"}),(0,a.jsx)("option",{value:"TAXA ADM",children:"TAXA ADM"}),(0,a.jsx)("option",{value:"CASSEMS",children:"CASSEMS"})]}),h.plan&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.plan})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor da Ades\xe3o"}),(0,a.jsx)("input",{type:"number",name:"adhesionValue",value:g.adhesionValue,onChange:y,step:"0.01",min:"0",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.adhesionValue?"border-red-500":"border-gray-300"),placeholder:"0.00"}),h.adhesionValue&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.adhesionValue})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Forma de Pagamento"}),(0,a.jsxs)("select",{name:"paymentMethod",value:g.paymentMethod,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.paymentMethod?"border-red-500":"border-gray-300"),children:[(0,a.jsx)("option",{value:"",children:"Selecione..."}),(0,a.jsx)("option",{value:"Cobrador",children:"Cobrador"}),(0,a.jsx)("option",{value:"PIX",children:"PIX"}),(0,a.jsx)("option",{value:"BOLETO",children:"BOLETO"}),(0,a.jsx)("option",{value:"D\xc9BITO",children:"D\xc9BITO"}),(0,a.jsx)("option",{value:"CR\xc9DITO",children:"CR\xc9DITO"}),(0,a.jsx)("option",{value:"DINHEIRO",children:"DINHEIRO"}),(0,a.jsx)("option",{value:"DESCONTO EM FOLHA",children:"DESCONTO EM FOLHA"})]}),h.paymentMethod&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.paymentMethod})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirma\xe7\xe3o"}),(0,a.jsx)("input",{type:"text",name:"confirmation",value:g.confirmation,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.confirmation?"border-red-500":"border-gray-300"),placeholder:"C\xf3digo de confirma\xe7\xe3o"}),h.confirmation&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.confirmation})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Origem"}),(0,a.jsxs)("select",{name:"origin",value:g.origin,onChange:y,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(h.origin?"border-red-500":"border-gray-300"),children:[(0,a.jsx)("option",{value:"",children:"Selecione a origem..."}),(0,a.jsx)("option",{value:"INDICA\xc7\xc3O CLIENTE",children:"INDICA\xc7\xc3O CLIENTE"}),(0,a.jsx)("option",{value:"INDICA\xc7\xc3O PARCEIRO",children:"INDICA\xc7\xc3O PARCEIRO"}),(0,a.jsx)("option",{value:"ANUNCIO",children:"ANUNCIO"}),(0,a.jsx)("option",{value:"LIGA\xc7\xc3O",children:"LIGA\xc7\xc3O"}),(0,a.jsx)("option",{value:"LISTA FRIA",children:"LISTA FRIA"}),(0,a.jsx)("option",{value:"EVENTO EXTERNO",children:"EVENTO EXTERNO"}),(0,a.jsx)("option",{value:"PRESENCIAL",children:"PRESENCIAL"}),(0,a.jsx)("option",{value:"REATIVA\xc7\xc3O",children:"REATIVA\xc7\xc3O"})]}),h.origin&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:h.origin})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendedor"}),(0,a.jsxs)("select",{name:"vendor",value:g.vendor,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Selecione um vendedor..."}),d.filter(e=>e.active).map(e=>(0,a.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lista Mensal"}),(0,a.jsxs)("select",{name:"listMonth",value:g.listMonth,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"janeiro",children:"Janeiro"}),(0,a.jsx)("option",{value:"fevereiro",children:"Fevereiro"}),(0,a.jsx)("option",{value:"mar\xe7o",children:"Mar\xe7o"}),(0,a.jsx)("option",{value:"abril",children:"Abril"}),(0,a.jsx)("option",{value:"maio",children:"Maio"}),(0,a.jsx)("option",{value:"junho",children:"Junho"}),(0,a.jsx)("option",{value:"julho",children:"Julho"}),(0,a.jsx)("option",{value:"agosto",children:"Agosto"}),(0,a.jsx)("option",{value:"setembro",children:"Setembro"}),(0,a.jsx)("option",{value:"outubro",children:"Outubro"}),(0,a.jsx)("option",{value:"novembro",children:"Novembro"}),(0,a.jsx)("option",{value:"dezembro",children:"Dezembro"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ano"}),(0,a.jsx)("input",{type:"number",name:"listYear",value:g.listYear,onChange:y,min:"2020",max:"2030",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observa\xe7\xe3o"}),(0,a.jsx)("textarea",{name:"observation",value:g.observation,onChange:y,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Observa\xe7\xf5es adicionais..."})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-6",children:(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",name:"homeVisit",checked:g.homeVisit,onChange:y,className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Visita \xe0 Casa"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",name:"paid",checked:g.paid,onChange:y,className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Pago"})]})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:x,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:x?"Salvando...":l?"Atualizar":"Criar Cliente"})]})]})]})})})}var q=s(7504);function U(e){let{onClose:t}=e,{selectedProject:s}=m(),{fetchClients:l}=R(),[n,i]=(0,r.useState)("upload"),[d,c]=(0,r.useState)(null),[x,u]=(0,r.useState)({}),[h,p]=(0,r.useState)([]),[g,j]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),[f,b]=(0,r.useState)(""),N=(0,r.useRef)(null),w=e=>{let t=new FileReader;t.onload=t=>{try{var s;let a=null===(s=t.target)||void 0===s?void 0:s.result,r=[];if(e.name.toLowerCase().endsWith(".csv")){let e=a.split("\n");e.length>0&&(r=e[0].split(",").map(e=>e.trim().replace(/"/g,"")))}else if(e.name.toLowerCase().endsWith(".xlsx")||e.name.toLowerCase().endsWith(".xls")){let e=q.ij(a,{type:"binary"}),t=e.SheetNames[0],s=e.Sheets[t],l=q.P6.sheet_to_json(s,{header:1});l.length>0&&(r=l[0].filter(e=>e&&""!==e.toString().trim()))}p(r)}catch(e){console.error("Erro ao detectar colunas:",e),p(["Nome","nome","NOME","Cliente","cliente","Telefone","telefone","TELEFONE","Fone","fone","Contrato","contrato","CONTRATO","N\xfamero","numero","Data Ades\xe3o","data_adesao","DataAdesao","Ades\xe3o","Data Contrato","data_contrato","DataContrato","Data Vencimento","data_vencimento","DataVencimento","Vencimento","Plano","plano","PLANO","Tipo","tipo","Valor","valor","VALOR","Pre\xe7o","preco","Pagamento","pagamento","PAGAMENTO","Forma Pagamento","Confirma\xe7\xe3o","confirmacao","CONFIRMACAO","Origem","origem","ORIGEM","Como Conheceu","Vendedor","vendedor","VENDEDOR","Respons\xe1vel"])}},e.name.toLowerCase().endsWith(".csv")?t.readAsText(e):t.readAsBinaryString(e)},C=(e,t)=>{u(s=>({...s,[e]:t}))},k=async()=>{if(d&&s){v(!0),b("");try{let e=new FormData;e.append("file",d),e.append("columnMapping",JSON.stringify(x));let t=await o.ZP.post("/clients/import/preview",e,{headers:{"Content-Type":"multipart/form-data"}});j(t.data),i("preview")}catch(s){var e,t;b((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Erro ao processar arquivo")}finally{v(!1)}}},D=async()=>{if(d&&s&&g){v(!0),i("importing"),b("");try{let e=new FormData;e.append("file",d),e.append("columnMapping",JSON.stringify(x)),e.append("projectId",s._id);let a=await o.ZP.post("/clients/import",e,{headers:{"Content-Type":"multipart/form-data"}});await l(s._id);let{summary:r,invalidClients:n}=a.data,i="".concat(r.imported," clientes importados com sucesso!");r.skipped>0&&(i+="\n\n".concat(r.skipped," clientes foram ignorados por n\xe3o terem nome ou telefone.")),r.errors>0&&(i+="\n\n".concat(r.errors," linhas tiveram erros de valida\xe7\xe3o.")),alert(i),t()}catch(t){var e,a;b((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Erro ao importar clientes"),i("preview")}finally{v(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Importar Clientes"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f&&(0,a.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-red-800",children:f})}),"upload"===n&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Importar Clientes"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Selecione um arquivo CSV ou Excel com os dados dos clientes"})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)("input",{ref:N,type:"file",accept:".csv,.xls,.xlsx",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){let e=s.name.toLowerCase().substring(s.name.lastIndexOf("."));["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(s.type)||[".csv",".xls",".xlsx"].includes(e)?(c(s),b(""),i("mapping"),w(s)):b("Apenas arquivos CSV e Excel s\xe3o permitidos")}},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"})}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Formatos suportados:"})," CSV, XLS, XLSX"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Tamanho m\xe1ximo:"})," 10MB"]}),(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"Primeira linha deve conter os cabe\xe7alhos das colunas"})})]})]}),"mapping"===n&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Mapear Colunas"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Selecione qual coluna do arquivo corresponde a cada campo do sistema"})]}),(0,a.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Object.entries({name:"Nome",phone:"Telefone",contract:"Contrato",adhesionDate:"Data da Ades\xe3o",contractDate:"Data de Contrato",dueDate:"Data de Vencimento",plan:"Plano",observation:"Observa\xe7\xe3o",adhesionValue:"Valor da Ades\xe3o",paymentMethod:"Forma de Pagamento",confirmation:"Confirma\xe7\xe3o",homeVisit:"Visita \xe0 Casa",origin:"Origem",vendor:"Vendedor",listMonth:"Lista Mensal",listYear:"Ano da Lista",paid:"Pago"}).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-1/3",children:(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:s})}),(0,a.jsx)("div",{className:"w-2/3",children:(0,a.jsxs)("select",{value:x[t]||"",onChange:e=>C(t,e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Selecione a coluna..."}),h.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})})]},t)})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{onClick:()=>{i("upload"),c(null),u({}),p([]),j(null),b(""),N.current&&(N.current.value="")},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Voltar"}),(0,a.jsx)("button",{onClick:k,disabled:y,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 transition-colors",children:y?"Processando...":"Visualizar"})]})]}),"preview"===n&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Preview da Importa\xe7\xe3o"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Revise os dados antes de importar"})]}),g&&(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Total de linhas:"})," ",g.totalRows]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"V\xe1lidas:"})," ",g.validRows]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Inv\xe1lidas:"})," ",g.invalidRows]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Taxa de sucesso:"})," ",g.totalRows>0?Math.round(g.validRows/g.totalRows*100):0,"%"]})]})}),(null==g?void 0:g.errors)&&g.errors.length>0&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-red-800 mb-2",children:"Erros encontrados:"}),(0,a.jsxs)("div",{className:"max-h-32 overflow-y-auto text-sm text-red-700",children:[g.errors.slice(0,10).map((e,t)=>(0,a.jsxs)("div",{className:"mb-1",children:[(0,a.jsxs)("strong",{children:["Linha ",e.row,":"]})," ",e.errors.join(", ")]},t)),g.errors.length>10&&(0,a.jsxs)("div",{className:"text-red-600",children:["... e mais ",g.errors.length-10," erros"]})]})]}),(null==g?void 0:g.data)&&g.data.length>0&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"Dados v\xe1lidos (primeiros 3 registros):"}),(0,a.jsx)("div",{className:"text-sm text-green-700",children:g.data.slice(0,3).map((e,t)=>(0,a.jsxs)("div",{className:"mb-2 p-2 bg-white rounded border",children:[(0,a.jsx)("strong",{children:e.name})," - ",e.phone," - ",e.plan]},t))})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{onClick:()=>i("mapping"),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Voltar"}),(0,a.jsx)("button",{onClick:D,disabled:y||0===((null==g?void 0:g.validRows)||0),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 transition-colors",children:y?"Importando...":"Importar Clientes"})]})]}),"importing"===n&&(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Importando Clientes"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Por favor, aguarde enquanto processamos os dados..."})]})]})})})}function H(){let{clients:e,isLoading:t,fetchClients:s,deleteClient:l,updateClient:n,setSelectedClient:i}=R(),{selectedProject:o}=m(),[d,c]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),[g,j]=(0,r.useState)(""),[y,v]=(0,r.useState)("createdAt"),[f,b]=(0,r.useState)("desc"),[N,w]=(0,r.useState)({startDate:"",endDate:""});(0,r.useEffect)(()=>{if(o){let e={startDate:N.startDate||void 0,endDate:N.endDate||void 0};s(o._id,e)}},[o,s,N]);let C=e=>{p(e),c(!0)},k=async e=>{if(window.confirm('Tem certeza que deseja deletar o cliente "'.concat(e.name,'"?')))try{await l(e._id)}catch(e){console.error("Erro ao deletar cliente:",e),alert("Erro ao deletar cliente")}},D=async e=>{try{await n(e._id,{paid:!e.paid})}catch(e){console.error("Erro ao atualizar status de pagamento:",e),alert("Erro ao atualizar status de pagamento")}},L=(e,t)=>{w(s=>({...s,[e]:t}))},S=e=>{let t=e.replace(/\D/g,""),s=t.startsWith("55")?t:"55".concat(t);return"https://wa.me/".concat(s)},E=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),P=e=>new Date(e).toLocaleDateString("pt-BR"),M=e.filter(e=>{let t=g.toLowerCase();return e.name.toLowerCase().includes(t)||e.phone.includes(g)||e.contract.toLowerCase().includes(t)||e.plan.toLowerCase().includes(t)}).sort((e,t)=>{let s=e[y],a=t[y];return"string"==typeof s&&"string"==typeof a?"asc"===f?s.localeCompare(a):a.localeCompare(s):"number"==typeof s&&"number"==typeof a?"asc"===f?s-a:a-s:s instanceof Date&&a instanceof Date?"asc"===f?s.getTime()-a.getTime():a.getTime()-s.getTime():0}),V=e=>{y===e?b("asc"===f?"desc":"asc"):(v(e),b("asc"))},A=e=>{let{field:t}=e;return y!==t?(0,a.jsx)("span",{className:"text-gray-400",children:"↕"}):"asc"===f?(0,a.jsx)("span",{children:"↑"}):(0,a.jsx)("span",{children:"↓"})};return o?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Clientes"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Gerencie seus clientes e contratos"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Data Ades\xe3o:"}),(0,a.jsx)("input",{type:"date",value:N.startDate,onChange:e=>L("startDate",e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm",placeholder:"In\xedcio"}),(0,a.jsx)("span",{className:"text-gray-500",children:"at\xe9"}),(0,a.jsx)("input",{type:"date",value:N.endDate,onChange:e=>L("endDate",e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm",placeholder:"Final"}),(N.startDate||N.endDate)&&(0,a.jsx)("button",{onClick:()=>{w({startDate:"",endDate:""})},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700 border border-gray-300 rounded hover:bg-gray-50",children:"Limpar"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar clientes...",value:g,onChange:e=>j(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"}),(0,a.jsx)("svg",{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,a.jsxs)("button",{onClick:()=>u(!0),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),(0,a.jsx)("span",{children:"Importar"})]}),(0,a.jsxs)("button",{onClick:()=>c(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsx)("span",{children:"Novo Cliente"})]})]})]}),t&&(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}),!t&&(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("name"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Nome"}),(0,a.jsx)(A,{field:"name"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("phone"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Telefone"}),(0,a.jsx)(A,{field:"phone"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("contract"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Contrato"}),(0,a.jsx)(A,{field:"contract"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("adhesionDate"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Ades\xe3o"}),(0,a.jsx)(A,{field:"adhesionDate"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("dueDate"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Vencimento"}),(0,a.jsx)(A,{field:"dueDate"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("plan"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Plano"}),(0,a.jsx)(A,{field:"plan"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("adhesionValue"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Valor"}),(0,a.jsx)(A,{field:"adhesionValue"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>V("paymentMethod"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Pagamento"}),(0,a.jsx)(A,{field:"paymentMethod"})]})}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pago"}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===M.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:11,className:"px-6 py-12 text-center text-gray-500",children:g?"Nenhum cliente encontrado para a busca":"Nenhum cliente cadastrado"})}):M.map(e=>{let t=new Date(e.dueDate)<new Date&&!e.paid,s=e.vendor;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 ".concat(t?"bg-red-50":""),children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),e.observation&&(0,a.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.observation})]})})}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:e.phone?(0,a.jsxs)("a",{href:S(e.phone),target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 flex items-center space-x-1",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),(0,a.jsx)("span",{children:e.phone})]}):(0,a.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:e.contract}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:P(e.adhesionDate)}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"text-sm ".concat(t?"text-red-600 font-medium":"text-gray-900"),children:P(e.dueDate)})}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:e.plan}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:E(e.adhesionValue)}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:e.paymentMethod}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-center",children:(0,a.jsx)("input",{type:"checkbox",checked:e.paid||!1,onChange:()=>D(e),className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"})}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[t&&(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Vencido"}),e.paid&&(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Pago"}),e.homeVisit&&(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Visita"}),s&&"object"==typeof s&&(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:s.name})]})}),(0,a.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>C(e),className:"text-primary-600 hover:text-primary-900 transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,a.jsx)("button",{onClick:()=>k(e),className:"text-red-600 hover:text-red-900 transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},e._id)})})]})})}),d&&(0,a.jsx)(W,{onClose:()=>{c(!1),p(null)},client:h||void 0,isEditing:!!h}),x&&(0,a.jsx)(U,{onClose:()=>u(!1)})]}):(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Selecione um projeto para visualizar os clientes"})})}function Z(e){var t;let{onClose:s,vendor:l,isEditing:n=!1}=e,{createVendor:i,updateVendor:o}=O(),[d,c]=(0,r.useState)(!1),[m,x]=(0,r.useState)({}),[u,h]=(0,r.useState)({name:(null==l?void 0:l.name)||"",email:(null==l?void 0:l.email)||"",phone:(null==l?void 0:l.phone)||"",active:null===(t=null==l?void 0:l.active)||void 0===t||t}),p=e=>{let{name:t,value:s,type:a,checked:r}=e.target;"checkbox"===a?h(e=>({...e,[t]:r})):h(e=>({...e,[t]:s})),m[t]&&x(e=>({...e,[t]:""}))},g=()=>{let e={};return u.name.trim()||(e.name="Nome \xe9 obrigat\xf3rio"),u.email.trim()||(e.email="Email \xe9 obrigat\xf3rio"),u.phone.trim()||(e.phone="Telefone \xe9 obrigat\xf3rio"),u.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)&&(e.email="Email inv\xe1lido"),x(e),0===Object.keys(e).length},j=async e=>{if(e.preventDefault(),g()){c(!0);try{n&&l?await o(l._id,u):await i(u),s()}catch(e){console.error("Erro ao salvar vendedor:",e)}finally{c(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:n?"Editar Vendedor":"Novo Vendedor"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),(0,a.jsx)("input",{type:"text",name:"name",value:u.name,onChange:p,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(m.name?"border-red-500":"border-gray-300"),placeholder:"Nome completo"}),m.name&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:m.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,a.jsx)("input",{type:"email",name:"email",value:u.email,onChange:p,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(m.email?"border-red-500":"border-gray-300"),placeholder:"email@exemplo.com"}),m.email&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:m.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone *"}),(0,a.jsx)("input",{type:"tel",name:"phone",value:u.phone,onChange:p,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(m.phone?"border-red-500":"border-gray-300"),placeholder:"(11) 99999-9999"}),m.phone&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:m.phone})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",name:"active",checked:u.active,onChange:p,className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Ativo"})]})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Salvando...":n?"Atualizar":"Criar Vendedor"})]})]})]})})})}function G(){let{vendors:e,isLoading:t,fetchVendors:s,deleteVendor:l}=O(),[n,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{s()},[s]);let c=e=>{d(e),i(!0)},m=async e=>{if(window.confirm('Tem certeza que deseja deletar o vendedor "'.concat(e.name,'"?')))try{await l(e._id)}catch(e){console.error("Erro ao deletar vendedor:",e),alert("Erro ao deletar vendedor")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Vendedores"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Gerencie seus vendedores"})]}),(0,a.jsxs)("button",{onClick:()=>i(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsx)("span",{children:"Novo Vendedor"})]})]}),t&&(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}),!t&&(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Telefone"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usu\xe1rio"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===e.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"Nenhum vendedor cadastrado"})}):e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.email}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.phone}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.active?"Ativo":"Inativo"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.user?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.user?"Vinculado":"N\xe3o vinculado"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>c(e),className:"text-primary-600 hover:text-primary-900 transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,a.jsx)("button",{onClick:()=>m(e),className:"text-red-600 hover:text-red-900 transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},e._id))})]})})}),n&&(0,a.jsx)(Z,{onClose:()=>{i(!1),d(null)},vendor:o||void 0,isEditing:!!o})]})}var J=s(9333),X=s(5064),K=s(6573),Y=s(4235),Q=s(39),$=s(6531),ee=s(229),et=s(8980),es=s(5223),ea=s(7460),er=s(6612);let el=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"];function en(){let{selectedProject:e}=m(),{vendors:t}=O(),[s,l]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1),[d,c]=(0,r.useState)({});(0,r.useEffect)(()=>{x()},[e,d]);let x=async()=>{if(e){i(!0);try{let t=new URLSearchParams;t.append("projectId",e._id),d.startDate&&t.append("startDate",d.startDate),d.endDate&&t.append("endDate",d.endDate),d.vendorId&&t.append("vendorId",d.vendorId),d.plan&&t.append("plan",d.plan),d.origin&&t.append("origin",d.origin),d.paymentMethod&&t.append("paymentMethod",d.paymentMethod),void 0!==d.confirmed&&t.append("confirmed",d.confirmed.toString()),void 0!==d.homeVisit&&t.append("homeVisit",d.homeVisit.toString());let s=await o.ZP.get("/analytics/clients?".concat(t.toString()));l(s.data)}catch(e){console.error("Erro ao buscar analytics:",e)}finally{i(!1)}}},u=(e,t)=>{c(s=>({...s,[e]:t}))};return e?n?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):s?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Dashboard de An\xe1lises"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Visualize os resultados dos seus clientes"})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filtros"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Inicial"}),(0,a.jsx)("input",{type:"date",value:d.startDate||"",onChange:e=>u("startDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Final"}),(0,a.jsx)("input",{type:"date",value:d.endDate||"",onChange:e=>u("endDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendedor"}),(0,a.jsxs)("select",{value:d.vendorId||"",onChange:e=>u("vendorId",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Todos os vendedores"}),t.filter(e=>e.active).map(e=>(0,a.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plano"}),(0,a.jsxs)("select",{value:d.plan||"",onChange:e=>u("plan",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Todos os planos"}),(0,a.jsx)("option",{value:"1GAVETA",children:"1GAVETA"}),(0,a.jsx)("option",{value:"2GAVETAS",children:"2GAVETAS"}),(0,a.jsx)("option",{value:"3GAVETAS",children:"3GAVETAS"}),(0,a.jsx)("option",{value:"TAXA ADM",children:"TAXA ADM"}),(0,a.jsx)("option",{value:"CASSEMS",children:"CASSEMS"})]})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)("button",{onClick:()=>{c({})},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Limpar Filtros"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total de Clientes"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.totalClients})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Valor Total"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["R$ ",s.totalValue.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Valor M\xe9dio"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["R$ ",s.averageValue.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Confirmados"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.confirmedVsUnconfirmed.confirmed})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Clientes por M\xeas"}),(0,a.jsx)(J.h,{width:"100%",height:300,children:(0,a.jsxs)(X.v,{data:s.monthlyClients,children:[(0,a.jsx)(K.q,{strokeDasharray:"3 3"}),(0,a.jsx)(Y.K,{dataKey:"month"}),(0,a.jsx)(Q.B,{}),(0,a.jsx)($.u,{}),(0,a.jsx)(ee.D,{}),(0,a.jsx)(et.$,{dataKey:"count",fill:"#0088FE",name:"Quantidade"})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Clientes por Plano"}),(0,a.jsx)(J.h,{width:"100%",height:300,children:(0,a.jsxs)(es.u,{children:[(0,a.jsx)(ea.b,{data:s.clientsByPlan,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{plan:t,count:s}=e;return"".concat(t,": ").concat(s)},outerRadius:80,fill:"#8884d8",dataKey:"count",children:s.clientsByPlan.map((e,t)=>(0,a.jsx)(er.b,{fill:el[t%el.length]},"cell-".concat(t)))}),(0,a.jsx)($.u,{})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Clientes por Vendedor"}),(0,a.jsx)(J.h,{width:"100%",height:300,children:(0,a.jsxs)(X.v,{data:s.clientsByVendor,children:[(0,a.jsx)(K.q,{strokeDasharray:"3 3"}),(0,a.jsx)(Y.K,{dataKey:"vendor"}),(0,a.jsx)(Q.B,{}),(0,a.jsx)($.u,{}),(0,a.jsx)(ee.D,{}),(0,a.jsx)(et.$,{dataKey:"count",fill:"#00C49F",name:"Quantidade"})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Status de Confirma\xe7\xe3o"}),(0,a.jsx)(J.h,{width:"100%",height:300,children:(0,a.jsxs)(es.u,{children:[(0,a.jsxs)(ea.b,{data:[{name:"Confirmados",value:s.confirmedVsUnconfirmed.confirmed},{name:"N\xe3o Confirmados",value:s.confirmedVsUnconfirmed.unconfirmed}],cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,value:s}=e;return"".concat(t,": ").concat(s)},outerRadius:80,fill:"#8884d8",dataKey:"value",children:[(0,a.jsx)(er.b,{fill:"#00C49F"}),(0,a.jsx)(er.b,{fill:"#FF8042"})]}),(0,a.jsx)($.u,{})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Resumo por Origem"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origem"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantidade"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentual"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.clientsByOrigin.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.origin}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.count}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(e.count/s.totalClients*100).toFixed(1),"%"]})]},t))})]})})]})]}):(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Nenhum dado encontrado"})}):(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Selecione um projeto para visualizar as an\xe1lises"})})}let ei=(0,i.Ue)((e,t)=>({coldLists:[],isLoading:!1,selectedColdList:null,dailyContactData:null,dailySummaryData:null,vendorContactsStats:null,fetchColdLists:async t=>{e({isLoading:!0});try{let s={};t&&(s.projectId=t);let a=await o.ZP.get("/cold-lists",{params:s});e({coldLists:a.data,isLoading:!1})}catch(t){console.error("Erro ao buscar listas de clientes frios:",t),e({isLoading:!1})}},createColdList:async s=>{try{let a=await o.ZP.post("/cold-lists",s);e({coldLists:[...t().coldLists,a.data]}),d.toast.success("Lista de clientes frios criada com sucesso!")}catch(e){throw console.error("Erro ao criar lista:",e),d.toast.error("Erro ao criar lista de clientes frios"),e}},updateColdList:async(s,a)=>{try{var r;let l=await o.ZP.put("/cold-lists/".concat(s),a),n=t().coldLists.map(e=>e._id===s?l.data:e);e({coldLists:n}),(null===(r=t().selectedColdList)||void 0===r?void 0:r._id)===s&&e({selectedColdList:l.data}),d.toast.success("Lista atualizada!")}catch(e){throw console.error("Erro ao atualizar lista:",e),d.toast.error("Erro ao atualizar lista"),e}},deleteColdList:async s=>{try{var a;await o.ZP.delete("/cold-lists/".concat(s));let r=t().coldLists.filter(e=>e._id!==s);e({coldLists:r}),(null===(a=t().selectedColdList)||void 0===a?void 0:a._id)===s&&e({selectedColdList:null}),d.toast.success("Lista deletada!")}catch(e){throw console.error("Erro ao deletar lista:",e),d.toast.error("Erro ao deletar lista"),e}},uploadColdListFile:async(e,t)=>{try{let s=new FormData;s.append("file",t);let a=await o.ZP.post("/cold-lists/".concat(e,"/upload"),s,{headers:{"Content-Type":"multipart/form-data"}});return d.toast.success(a.data.message),a.data}catch(e){throw console.error("Erro ao fazer upload:",e),d.toast.error("Erro ao fazer upload do arquivo"),e}},previewColdListFile:async(e,t)=>{try{let s=new FormData;return s.append("file",t),(await o.ZP.post("/cold-lists/".concat(e,"/preview"),s,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){throw console.error("Erro ao fazer preview:",e),d.toast.error("Erro ao fazer preview do arquivo"),e}},importColdListFile:async(e,t,s)=>{try{let a=new FormData;a.append("file",s),a.append("columnMapping",JSON.stringify(t));let r=await o.ZP.post("/cold-lists/".concat(e,"/import"),a,{headers:{"Content-Type":"multipart/form-data"}});return d.toast.success(r.data.message),r.data}catch(e){throw console.error("Erro ao importar:",e),d.toast.error("Erro ao importar clientes"),e}},generateTasks:async e=>{try{let s=await o.ZP.post("/cold-lists/".concat(e,"/generate-tasks"));return await t().fetchColdLists(),d.toast.success(s.data.message),s.data}catch(e){throw console.error("Erro ao gerar tarefas:",e),d.toast.error("Erro ao gerar tarefas"),e}},setSelectedColdList:t=>{e({selectedColdList:t})},fetchDailyContacts:async(t,s)=>{e({isLoading:!0});try{let a={};s&&(a.date=s);let r=await o.ZP.get("/cold-lists/".concat(t,"/daily-contacts"),{params:a});e({dailyContactData:r.data,isLoading:!1})}catch(t){console.error("Erro ao buscar contatos di\xe1rios:",t),e({isLoading:!1}),d.toast.error("Erro ao carregar contatos do dia")}},updateClientContact:async(s,a,r)=>{let l=t().dailyContactData;if(l){let t=[...l.clients],s=t[a];s.contacted,s.contactDate,s.contactedBy,t[a]={...s,contacted:r,contactDate:r?new Date().toISOString():null,contactedBy:r?"current-user":null};let n=t.filter(e=>e.contacted).length,i=t.length>0?Math.round(n/t.length*100):0;e({dailyContactData:{...l,clients:t,stats:{...l.stats,contactedClients:n,contactPercentage:i}}})}o.ZP.put("/cold-lists/".concat(s,"/contact-client"),{clientIndex:a,contacted:r}).then(s=>{let r=t().dailyContactData;if(r){let t=[...r.clients];t[a]=s.data.client;let l=t.filter(e=>e.contacted).length,n=t.length>0?Math.round(l/t.length*100):0;e({dailyContactData:{...r,clients:t,stats:{...r.stats,contactedClients:l,contactPercentage:n}}})}}).catch(s=>{console.error("Erro ao sincronizar com servidor:",s);let l=t().dailyContactData;if(l){let t=[...l.clients],s=t[a];t[a]={...s,contacted:!r,contactDate:s.contacted?s.contactDate:null,contactedBy:s.contacted?s.contactedBy:null};let n=t.filter(e=>e.contacted).length,i=t.length>0?Math.round(n/t.length*100):0;e({dailyContactData:{...l,clients:t,stats:{...l.stats,contactedClients:n,contactPercentage:i}}}),d.toast.error("Erro ao salvar. Mudan\xe7as revertidas.")}})},fetchDailySummary:async t=>{e({isLoading:!0});try{let s={};t&&(s.date=t);let a=await o.ZP.get("/cold-lists/assigned/daily-summary",{params:s});e({dailySummaryData:a.data,isLoading:!1})}catch(t){console.error("Erro ao buscar resumo di\xe1rio:",t),e({isLoading:!1}),d.toast.error("Erro ao carregar resumo di\xe1rio")}},redistributeClients:async e=>{try{let s=await o.ZP.post("/cold-lists/".concat(e,"/redistribute"));return d.toast.success(s.data.message),await t().fetchColdLists(),s.data}catch(e){throw console.error("Erro ao redistribuir clientes:",e),d.toast.error("Erro ao redistribuir clientes"),e}},fetchVendorContactsStats:async t=>{e({isLoading:!0});try{let s=new URLSearchParams;t&&s.append("date",t);let a=await o.ZP.get("/cold-lists/vendor-contacts-stats?".concat(s.toString()));return e({vendorContactsStats:a.data,isLoading:!1}),a.data}catch(t){throw console.error("Erro ao buscar estat\xedsticas de vendedores:",t),e({isLoading:!1}),d.toast.error("Erro ao carregar estat\xedsticas de vendedores"),t}}}));function eo(e){let{isOpen:t,onClose:s,coldListId:l,coldListName:n}=e,{previewColdListFile:i,importColdListFile:o,fetchColdLists:d}=ei(),[c,m]=(0,r.useState)(null),[x,u]=(0,r.useState)(null),[h,p]=(0,r.useState)({name:"",phone:""}),[g,j]=(0,r.useState)(!1),[y,v]=(0,r.useState)("upload"),f=async()=>{if(c){j(!0);try{let e=await i(l,c);u(e),v("mapping")}catch(e){console.error("Erro ao fazer preview:",e)}finally{j(!1)}}},b=async()=>{if(x&&c){j(!0),v("importing");try{await o(l,h,c),await d(),s(),N()}catch(e){console.error("Erro ao importar:",e)}finally{j(!1)}}},N=()=>{m(null),u(null),p({name:"",phone:""}),v("upload")},w=()=>{s(),N()};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Importar Planilha - ",n]}),(0,a.jsx)("button",{onClick:w,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),"upload"===y&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Arquivo Excel (XLS/XLSX)"}),(0,a.jsx)("input",{type:"file",accept:".xls,.xlsx",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&m(s)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"A planilha deve conter as colunas: Nome e Telefone"})]}),c&&(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,a.jsx)("strong",{children:"Arquivo selecionado:"})," ",c.name]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Tamanho: ",(c.size/1024/1024).toFixed(2)," MB"]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{onClick:f,disabled:!c||g,className:"flex-1 bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g?"Processando...":"Fazer Preview"}),(0,a.jsx)("button",{onClick:w,className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300 transition-colors",children:"Cancelar"})]})]}),"mapping"===y&&x&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Preview da Planilha"}),(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:["Total de linhas: ",x.totalRows," | Colunas encontradas: ",x.columns.length]}),(0,a.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:["\uD83D\uDCCA ",x.totalRows," registros ser\xe3o processados na importa\xe7\xe3o"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Mapear Colunas"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Cliente *"}),(0,a.jsxs)("select",{value:h.name,onChange:e=>p(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Selecione a coluna"}),x.columns.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone *"}),(0,a.jsxs)("select",{value:h.phone,onChange:e=>p(t=>({...t,phone:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Selecione a coluna"}),x.columns.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Preview dos Dados"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Telefone"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.preview.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.name&&e[h.name]||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.phone&&e[h.phone]||"-"})]},t))})]})})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{onClick:b,disabled:!h.name||!h.phone||g,className:"flex-1 bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g?"Importando...":"Importar Clientes"}),(0,a.jsx)("button",{onClick:()=>v("upload"),className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300 transition-colors",children:"Voltar"})]})]}),"importing"===y&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Importando clientes..."})]})]})})}):null}function ed(){let{coldLists:e,isLoading:t,fetchColdLists:s,createColdList:l,deleteColdList:i,generateTasks:o,uploadColdListFile:d,redistributeClients:c}=ei(),{vendors:x,fetchVendors:u}=O(),{selectedProject:h}=m(),{user:p}=(0,n.t)(),[g,j]=(0,r.useState)(!1),[y,v]=(0,r.useState)(null),[f,b]=(0,r.useState)(null),[N,w]=(0,r.useState)(!1),[C,k]=(0,r.useState)("all"),[D,L]=(0,r.useState)(null),[S,E]=(0,r.useState)({name:"",description:"",clientsPerDay:10,clientsPerVendor:5,selectedVendors:[],startDate:"",endDate:"",assignedUserId:(null==p?void 0:p.id)||""}),[P,M]=(0,r.useState)({});(0,r.useEffect)(()=>{h&&(s(h._id),u())},[h,s,u]);let V=e=>{let{name:t,value:s}=e.target;E(e=>({...e,[t]:"clientsPerDay"===t||"clientsPerVendor"===t?parseInt(s)||0:s})),P[t]&&M(e=>({...e,[t]:""}))},A=e=>{E(t=>({...t,selectedVendors:t.selectedVendors.includes(e)?t.selectedVendors.filter(t=>t!==e):[...t.selectedVendors,e]}))},T=()=>{let e={};return S.name.trim()||(e.name="Nome da lista \xe9 obrigat\xf3rio"),S.clientsPerDay<1&&(e.clientsPerDay="Deve ser pelo menos 1"),S.clientsPerVendor<1&&(e.clientsPerVendor="Deve ser pelo menos 1"),0===S.selectedVendors.length&&(e.selectedVendors="Selecione pelo menos um vendedor"),S.startDate||(e.startDate="Data de in\xedcio \xe9 obrigat\xf3ria"),S.endDate||(e.endDate="Data de fim \xe9 obrigat\xf3ria"),S.startDate&&S.endDate&&new Date(S.startDate)>=new Date(S.endDate)&&(e.endDate="Data de fim deve ser posterior \xe0 data de in\xedcio"),M(e),0===Object.keys(e).length},_=async e=>{if(e.preventDefault(),T()&&h)try{let e={name:S.name,description:S.description,clientsPerDay:S.clientsPerDay,clientsPerVendor:S.clientsPerVendor,selectedVendors:S.selectedVendors,startDate:S.startDate,endDate:S.endDate,projectId:h._id,assignedUserId:S.assignedUserId||(null==p?void 0:p.id)};y||await l(e),B()}catch(e){console.error("Erro ao salvar lista:",e)}},B=()=>{E({name:"",description:"",clientsPerDay:10,clientsPerVendor:5,selectedVendors:[],startDate:"",endDate:"",assignedUserId:(null==p?void 0:p.id)||""}),M({}),j(!1),v(null)},I=async e=>{if(confirm("Tem certeza que deseja deletar esta lista?"))try{await i(e)}catch(e){console.error("Erro ao deletar lista:",e)}},z=async e=>{if(confirm("Gerar tarefas para todos os vendedores? Esta a\xe7\xe3o n\xe3o pode ser desfeita."))try{await o(e)}catch(e){console.error("Erro ao gerar tarefas:",e)}},F=async e=>{if(confirm("Redistribuir clientes da lista? Esta a\xe7\xe3o ir\xe1 limpar todas as marca\xe7\xf5es de contato existentes."))try{await c(e)}catch(e){console.error("Erro ao redistribuir clientes:",e)}},R=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},W=e=>{switch(e){case"pending":return"Pendente";case"processing":return"Processando";case"completed":return"Conclu\xedda";case"cancelled":return"Cancelada";default:return e}},q=()=>{if(!p)return e;switch(C){case"my":return e.filter(e=>{var t;let s="string"==typeof e.assignedUser?e.assignedUser:null===(t=e.assignedUser)||void 0===t?void 0:t.id;return e.owner===p.id||s===p.id});case"assigned":return e.filter(e=>{var t;return("string"==typeof e.assignedUser?e.assignedUser:null===(t=e.assignedUser)||void 0===t?void 0:t.id)===p.id});default:return e}};return(0,a.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Listas de Clientes Frios"}),(0,a.jsxs)("button",{onClick:()=>j(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 transition-colors",children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nova Lista"]})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>k("all"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("all"===C?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Todas as Listas"}),(0,a.jsx)("button",{onClick:()=>k("my"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("my"===C?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Minhas Listas"}),(0,a.jsx)("button",{onClick:()=>k("assigned"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("assigned"===C?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Listas Atribu\xeddas"})]})})}),g&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:y?"Editar Lista":"Nova Lista de Clientes Frios"}),(0,a.jsx)("button",{onClick:B,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Lista *"}),(0,a.jsx)("input",{type:"text",name:"name",value:S.name,onChange:V,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(P.name?"border-red-500":"border-gray-300"),placeholder:"Ex: Lista Janeiro 2024"}),P.name&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:P.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,a.jsx)("textarea",{name:"description",value:S.description,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,placeholder:"Descri\xe7\xe3o da lista..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clientes por Dia *"}),(0,a.jsx)("input",{type:"number",name:"clientsPerDay",value:S.clientsPerDay,onChange:V,min:"1",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(P.clientsPerDay?"border-red-500":"border-gray-300")}),P.clientsPerDay&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:P.clientsPerDay})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clientes por Vendedor *"}),(0,a.jsx)("input",{type:"number",name:"clientsPerVendor",value:S.clientsPerVendor,onChange:V,min:"1",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(P.clientsPerVendor?"border-red-500":"border-gray-300")}),P.clientsPerVendor&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:P.clientsPerVendor})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vendedores *"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto border border-gray-300 rounded-md p-3",children:x.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.selectedVendors.includes(e._id),onChange:()=>A(e._id),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:e.name})]},e._id))}),P.selectedVendors&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:P.selectedVendors})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Atribuir para usu\xe1rio espec\xedfico (opcional)"}),(0,a.jsxs)("select",{name:"assignedUserId",value:S.assignedUserId,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsxs)("option",{value:(null==p?void 0:p.id)||"",children:["Eu mesmo (",(null==p?void 0:p.name)||"Usu\xe1rio",")"]}),x.filter(e=>e.user).map(e=>(0,a.jsxs)("option",{value:e.user,children:[e.name," (",e.email,")"]},e._id))]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Selecione para quem a lista ser\xe1 atribu\xedda"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de In\xedcio *"}),(0,a.jsx)("input",{type:"date",name:"startDate",value:S.startDate,onChange:V,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(P.startDate?"border-red-500":"border-gray-300")}),P.startDate&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:P.startDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Fim *"}),(0,a.jsx)("input",{type:"date",name:"endDate",value:S.endDate,onChange:V,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(P.endDate?"border-red-500":"border-gray-300")}),P.endDate&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:P.endDate})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 transition-colors",children:y?"Atualizar":"Criar Lista"}),(0,a.jsx)("button",{type:"button",onClick:B,className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300 transition-colors",children:"Cancelar"})]})]})]})})}),t?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"Carregando listas..."})]}):0===q().length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Nenhuma lista encontrada"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Comece criando uma nova lista de clientes frios."})]}):(0,a.jsxs)(a.Fragment,{children:["assigned"===C&&(0,a.jsx)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Resumo das Listas Atribu\xeddas"}),(0,a.jsxs)("p",{className:"text-sm text-blue-600",children:[q().length," lista(s) atribu\xedda(s) para voc\xea"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:q().reduce((e,t)=>e+(t.importedClients?t.importedClients.length:0),0)}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"clientes importados"})]})]})}),(0,a.jsx)("div",{className:"grid gap-4",children:q().map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(R(e.status)),children:W(e.status)}),e.assignedUser&&"object"==typeof e.assignedUser&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["Para: ",e.assignedUser.name]}),e.importedClients&&e.importedClients.length>0&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["\uD83D\uDCCB ",e.importedClients.length," clientes"]})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Clientes/Dia:"}),(0,a.jsx)("span",{className:"ml-1 font-medium",children:e.clientsPerDay})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Por Vendedor:"}),(0,a.jsx)("span",{className:"ml-1 font-medium",children:e.clientsPerVendor})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Vendedores:"}),(0,a.jsx)("span",{className:"ml-1 font-medium",children:e.selectedVendors.length})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Total Clientes:"}),(0,a.jsx)("span",{className:"ml-1 font-medium",children:e.totalClients})]})]}),e.importedClients&&e.importedClients.length>0&&(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.importedClients.length," clientes importados"]})}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:[(0,a.jsxs)("span",{children:["Per\xedodo: ",new Date(e.startDate).toLocaleDateString("pt-BR")," - ",new Date(e.endDate).toLocaleDateString("pt-BR")]}),e.tasksGenerated>0&&(0,a.jsxs)("span",{className:"ml-4",children:["Tarefas: ",e.tasksGenerated]})]}),e.importedClients.length>0&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Clientes Importados (",e.importedClients.length,")"]}),(0,a.jsxs)("button",{onClick:()=>L(D===e._id?null:e._id),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[(0,a.jsx)("span",{children:D===e._id?"Ocultar":"Ver Todos"}),(0,a.jsx)("svg",{className:"w-4 h-4 transition-transform ".concat(D===e._id?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),D===e._id?(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto bg-gray-50 p-3 rounded border",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 text-xs",children:e.importedClients.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white p-2 rounded border flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 truncate",title:e.name,children:e.name}),(0,a.jsx)("div",{className:"text-gray-500 truncate",title:e.phone,children:e.phone})]}),(0,a.jsx)("a",{href:"https://wa.me/55".concat(e.phone.replace(/\D/g,"")),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-green-600 hover:text-green-800 flex-shrink-0",title:"Abrir WhatsApp",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})})})]},t))})}):(0,a.jsxs)("div",{className:"max-h-32 overflow-y-auto bg-gray-50 p-2 rounded text-xs",children:[e.importedClients.slice(0,10).map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between py-1",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)("span",{className:"text-gray-500",children:e.phone})]},t)),e.importedClients.length>10&&(0,a.jsxs)("p",{className:"text-gray-500 text-center py-1",children:["... e mais ",e.importedClients.length-10," clientes"]})]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 ml-4",children:["pending"===e.status&&0===e.importedClients.length&&(0,a.jsx)("button",{onClick:()=>{b(e),w(!0)},className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors",children:"Upload Excel"}),"pending"===e.status&&e.importedClients.length>0&&(0,a.jsx)("button",{onClick:()=>z(e._id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors",children:"Gerar Tarefas"}),"completed"===e.status&&e.importedClients.length>0&&(0,a.jsx)("button",{onClick:()=>F(e._id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors",children:"Redistribuir"}),(0,a.jsx)("button",{onClick:()=>I(e._id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Deletar"})]})]})},e._id))})]}),N&&f&&(0,a.jsx)(eo,{isOpen:N,onClose:()=>{w(!1),b(null)},coldListId:f._id,coldListName:f.name})]})}function ec(){let{dailyContactData:e,dailySummaryData:t,isLoading:s,fetchDailyContacts:l,updateClientContact:i,fetchDailySummary:o}=ei(),{user:d}=(0,n.t)(),[c,m]=(0,r.useState)(new Date().toISOString().split("T")[0]),[x,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{c&&o(c)},[c,o]);let g=e=>{m(e),x&&l(x,e)},j=e=>{u(e),l(e,c)},y=(e,t)=>{x&&(p(t=>new Set(t).add(e)),i(x,e,t).finally(()=>{setTimeout(()=>{p(t=>{let s=new Set(t);return s.delete(e),s})},1e3)}))},v=e=>{let t=e.replace(/\D/g,"");return t.startsWith("55")?t:"55".concat(t)},f=e=>e>=80?"bg-green-500":e>=60?"bg-yellow-500":e>=40?"bg-orange-500":"bg-red-500";return(0,a.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Contatos Di\xe1rios"}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsx)("input",{type:"date",value:c,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})})]}),t&&(0,a.jsxs)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:["Resumo do Dia - ",new Date(c).toLocaleDateString("pt-BR")]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:t.overallStats.totalClients}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Total de Clientes"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:t.overallStats.contactedClients}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Contatados"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:[t.overallStats.contactPercentage,"%"]}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Taxa de Contato"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-blue-600 mb-1",children:[(0,a.jsx)("span",{children:"Progresso Geral"}),(0,a.jsxs)("span",{children:[t.overallStats.contactedClients,"/",t.overallStats.totalClients]})]}),(0,a.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(f(t.overallStats.contactPercentage)),style:{width:"".concat(t.overallStats.contactPercentage,"%")}})})]})]}),t&&t.summary.length>0?(0,a.jsx)("div",{className:"space-y-4",children:t.summary.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.coldListName}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Vendedor: ",e.vendorName]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Progresso"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(f(e.contactPercentage)),style:{width:"".concat(e.contactPercentage,"%")}})}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[e.contactPercentage,"%"]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[e.contactedClients,"/",e.totalClients," contatados"]})]})]}),(0,a.jsx)("button",{onClick:()=>j(e.coldListId),className:"w-full bg-primary-600 text-white py-2 px-4 rounded-md hover:bg-primary-700 transition-colors",children:"Ver Lista de Clientes"})]},e.coldListId))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Nenhum cliente para hoje"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"N\xe3o h\xe1 clientes atribu\xeddos para contato na data selecionada."})]}),x&&e&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:e.coldList.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:new Date(c).toLocaleDateString("pt-BR")})]}),(0,a.jsx)("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"mb-6 bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:e.stats.totalClients}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total de Clientes"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.stats.contactedClients}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Contatados"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[e.stats.contactPercentage,"%"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Taxa de Contato"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Progresso"}),(0,a.jsxs)("span",{children:[e.stats.contactedClients,"/",e.stats.totalClients]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat(f(e.stats.contactPercentage)),style:{width:"".concat(e.stats.contactPercentage,"%")}})})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:e.clients.map((e,t)=>(0,a.jsx)("div",{className:"border rounded-lg p-4 transition-colors ".concat(e.contacted?"bg-green-50 border-green-200":"bg-white border-gray-200"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.contacted,onChange:e=>y(t,e.target.checked),className:"w-5 h-5 text-green-600 border-gray-300 rounded focus:ring-green-500"}),h.has(t)&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full animate-pulse"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.phone})]})]}),e.contacted&&e.contactDate&&(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Contatado em: ",new Date(e.contactDate).toLocaleString("pt-BR")]})]}),(0,a.jsxs)("a",{href:"https://wa.me/".concat(v(e.phone)),target:"_blank",rel:"noopener noreferrer",className:"ml-4 bg-green-600 text-white px-3 py-2 rounded-md hover:bg-green-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),(0,a.jsx)("span",{children:"WhatsApp"})]})]})},t))}),0===e.clients.length&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Nenhum cliente encontrado para esta data."})})]})})}),s&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"}),(0,a.jsx)("span",{className:"text-gray-700",children:"Carregando..."})]})})]})}function em(){var e,t;let s=(0,l.useRouter)(),{vendorContactsStats:n,isLoading:i,fetchVendorContactsStats:o}=ei(),[d,c]=(0,r.useState)(new Date().toISOString().split("T")[0]),[m,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{o(d)},[d,o]);let u=e=>"".concat(e,"%"),h=e=>{let t={in_progress:{color:"bg-blue-100 text-blue-800",label:"Em Andamento"},completed:{color:"bg-green-100 text-green-800",label:"Conclu\xedda"}},s=t[e]||t.in_progress;return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(s.color),children:s.label})};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Contatos por Vendedor"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Acompanhe o desempenho de cada vendedor nos contatos di\xe1rios"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Data de refer\xeancia:"}),(0,a.jsx)("input",{type:"date",value:d,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})}),(null==n?void 0:n.summary)&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total de Vendedores"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:n.summary.totalVendors})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total de Clientes"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:n.summary.totalClients.toLocaleString()})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Clientes Contatados"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:n.summary.totalContacted.toLocaleString()})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Taxa de Contato"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:u(n.summary.overallPercentage)})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Desempenho por Vendedor"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendedor"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Listas"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total de Clientes"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contatos Realizados"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Taxa de Contato"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Detalhes"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:i?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"Carregando..."})}):(null==n?void 0:null===(e=n.vendorStats)||void 0===e?void 0:e.length)===0?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"Nenhum vendedor encontrado"})}):null==n?void 0:null===(t=n.vendorStats)||void 0===t?void 0:t.map(e=>(0,a.jsxs)(r.Fragment,{children:[(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-medium text-primary-600",children:e.vendorName.charAt(0).toUpperCase()})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.vendorName}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.vendorEmail})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.totalLists}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.totalClients.toLocaleString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.contactedClients.toLocaleString()}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:(0,a.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"".concat(e.contactPercentage,"%")}})})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.contactPercentage>=80?"bg-green-100 text-green-800":e.contactPercentage>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:u(e.contactPercentage)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsxs)("button",{onClick:()=>x(m===e.vendorId?null:e.vendorId),className:"text-primary-600 hover:text-primary-900 flex items-center space-x-1",children:[(0,a.jsxs)("span",{children:[m===e.vendorId?"Ocultar":"Ver"," detalhes"]}),(0,a.jsx)("svg",{className:"w-4 h-4 transition-transform ".concat(m===e.vendorId?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]}),m===e.vendorId&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-4 bg-gray-50",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:["Detalhes das Listas - ",e.vendorName]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lista"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Projeto"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clientes"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contatados"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Taxa"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.lists.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:e.listName}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:e.projectName}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:h(e.status)}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:e.clients.toLocaleString()}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:e.contacted.toLocaleString()}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.contactPercentage>=80?"bg-green-100 text-green-800":e.contactPercentage>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:u(e.contactPercentage)})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsx)("button",{onClick:()=>{s.push("/dashboard?view=daily-contacts&list=".concat(e.listId))},className:"text-primary-600 hover:text-primary-900 mr-3",children:"Ver contatos"})})]},e.listId))})]})}),(0,a.jsxs)("div",{className:"mt-4 p-4 bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Resumo do Vendedor"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Total de Listas:"}),(0,a.jsx)("span",{className:"ml-2 font-medium text-gray-900",children:e.totalLists})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Total de Clientes:"}),(0,a.jsx)("span",{className:"ml-2 font-medium text-gray-900",children:e.totalClients.toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Contatos Realizados:"}),(0,a.jsx)("span",{className:"ml-2 font-medium text-gray-900",children:e.contactedClients.toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Taxa Geral:"}),(0,a.jsx)("span",{className:"ml-2 font-medium ".concat(e.contactPercentage>=80?"text-green-600":e.contactPercentage>=60?"text-yellow-600":"text-red-600"),children:u(e.contactPercentage)})]})]})]})]})})})]},e.vendorId))})]})})]})]})}function ex(){let e=(0,l.useRouter)(),{isAuthenticated:t,loadUser:s}=(0,n.t)(),{selectedTask:i}=c(),{selectedProject:o,fetchProjects:d,createDefaultProject:x}=m(),[u,h]=(0,r.useState)("kanban"),[p,g]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{s()},[s]),(0,r.useEffect)(()=>{t||e.push("/login")},[t,e]),(0,r.useEffect)(()=>{(async()=>{if(t){await d();let e=await d();(void 0===e||Array.isArray(e)&&0===e.length)&&await x()}})()},[t,d,x]),t)?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)(y,{}),(0,a.jsx)(F,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"clients"===u?"Clientes":"vendors"===u?"Vendedores":"analytics"===u?"Dashboard":"cold-lists"===u?"Listas de Clientes Frios":"daily-contacts"===u?"Contatos Di\xe1rios":"overview"===u?"Contatos por Vendedor":"Minhas Tarefas"}),(0,a.jsx)(z,{})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-1 flex space-x-1",children:[(0,a.jsxs)("button",{onClick:()=>h("kanban"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("kanban"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),"Kanban"]}),(0,a.jsxs)("button",{onClick:()=>h("calendar"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("calendar"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Calend\xe1rio"]}),(0,a.jsxs)("button",{onClick:()=>h("clients"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("clients"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Clientes"]}),(0,a.jsxs)("button",{onClick:()=>h("vendors"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("vendors"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Vendedores"]}),(0,a.jsxs)("button",{onClick:()=>h("analytics"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("analytics"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Dashboard"]}),(0,a.jsxs)("button",{onClick:()=>h("cold-lists"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("cold-lists"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Clientes Frios"]}),(0,a.jsxs)("button",{onClick:()=>h("daily-contacts"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("daily-contacts"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"Contatos Di\xe1rios"]}),(0,a.jsxs)("button",{onClick:()=>h("overview"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("overview"===u?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),"Contatos/Vendedor"]})]}),"clients"!==u&&"vendors"!==u&&"analytics"!==u&&"cold-lists"!==u&&"daily-contacts"!==u&&"overview"!==u&&(0,a.jsxs)("button",{onClick:()=>g(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-primary-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsx)("span",{children:"Nova Tarefa"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm",children:"kanban"===u?(0,a.jsx)(S,{}):"calendar"===u?(0,a.jsx)(M,{}):"clients"===u?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(H,{})}):"vendors"===u?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(G,{})}):"analytics"===u?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(en,{})}):"cold-lists"===u?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(ed,{})}):"daily-contacts"===u?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(ec,{})}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(em,{})})})]}),i&&(0,a.jsx)(B,{}),p&&(0,a.jsx)(I,{onClose:()=>g(!1)})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}},8222:function(e,t,s){"use strict";s.d(t,{HF:function(){return d},iJ:function(){return n},lC:function(){return o},qx:function(){return i}});var a=s(4829);let r="http://localhost:5000/api",l=a.Z.create({baseURL:r,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)}),t.ZP=l;let n={register:e=>l.post("/auth/register",e),login:e=>l.post("/auth/login",e),getMe:()=>l.get("/auth/me"),getUsers:()=>l.get("/auth/users"),getUserByEmail:e=>l.get("/auth/users/by-email/".concat(e)),verifyEmail:e=>l.get("/auth/verify-email?token=".concat(e)),resendVerification:()=>l.post("/auth/resend-verification")},i={getAll:e=>l.get("/projects",{params:{includeArchived:e}}),getById:e=>l.get("/projects/".concat(e)),create:e=>l.post("/projects",e),update:(e,t)=>l.put("/projects/".concat(e),t),delete:e=>l.delete("/projects/".concat(e)),addMember:(e,t,s)=>l.post("/projects/".concat(e,"/members"),{userId:t,role:s}),removeMember:(e,t)=>l.delete("/projects/".concat(e,"/members/").concat(t)),updateMemberRole:(e,t,s)=>l.put("/projects/".concat(e,"/members/").concat(t),{role:s}),createDefault:()=>l.post("/projects/create-default")},o={getAll:e=>l.get("/tasks",{params:{projectId:e}}),getById:e=>l.get("/tasks/".concat(e)),create:e=>l.post("/tasks",e),update:(e,t)=>l.put("/tasks/".concat(e),t),delete:e=>l.delete("/tasks/".concat(e)),reorder:e=>l.post("/tasks/reorder",{tasks:e}),uploadAttachment:(e,t)=>{let s=new FormData;return s.append("file",t),l.post("/tasks/".concat(e,"/attachments"),s,{headers:{"Content-Type":"multipart/form-data"}})},deleteAttachment:(e,t)=>l.delete("/tasks/".concat(e,"/attachments/").concat(t)),downloadAttachment:(e,t)=>"".concat(r,"/tasks/").concat(e,"/attachments/").concat(t,"/download")},d={getByTask:e=>l.get("/comments/task/".concat(e)),create:e=>l.post("/comments",e),update:(e,t)=>l.put("/comments/".concat(e),t),delete:e=>l.delete("/comments/".concat(e))}},8958:function(e,t,s){"use strict";s.d(t,{t:function(){return n}});var a=s(4660),r=s(8222),l=s(5925);let n=(0,a.Ue)(e=>({user:null,token:null,isAuthenticated:!1,login:async(t,s)=>{try{let{token:a,user:n}=(await r.iJ.login({email:t,password:s})).data;localStorage.setItem("token",a),localStorage.setItem("user",JSON.stringify(n)),e({user:n,token:a,isAuthenticated:!0}),l.default.success("Login realizado com sucesso!")}catch(t){var a,n;let e=(null===(n=t.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||"Erro ao fazer login";throw l.default.error(e),t}},register:async(t,s,a)=>{try{let{token:n,user:i}=(await r.iJ.register({name:t,email:s,password:a})).data;localStorage.setItem("token",n),localStorage.setItem("user",JSON.stringify(i)),e({user:i,token:n,isAuthenticated:!0}),l.default.success("Conta criada com sucesso!")}catch(t){var n,i;let e=(null===(i=t.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.message)||"Erro ao criar conta";throw l.default.error(e),t}},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),e({user:null,token:null,isAuthenticated:!1}),l.default.success("Logout realizado com sucesso!")},loadUser:async()=>{let t=localStorage.getItem("token"),s=localStorage.getItem("user");if(t&&s)try{let a=JSON.parse(s);e({user:a,token:t,isAuthenticated:!0})}catch(e){console.error("Erro ao carregar usu\xe1rio:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}}}))}},function(e){e.O(0,[425,600,810,331,971,938,744],function(){return e(e.s=1386)}),_N_E=e.O()}]);