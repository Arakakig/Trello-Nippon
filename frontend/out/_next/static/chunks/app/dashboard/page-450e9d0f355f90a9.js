(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{1386:function(e,r,t){Promise.resolve().then(t.bind(t,3078))},3078:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return W}});var a=t(7437),s=t(2265),o=t(4033),l=t(8958),i=t(4660),n=t(8222),d=t(5925);let c=(0,i.Ue)((e,r)=>({tasks:[],selectedTask:null,isLoading:!1,fetchTasks:async r=>{e({isLoading:!0});try{let t=await n.lC.getAll(r);e({tasks:t.data,isLoading:!1})}catch(r){console.error("Erro ao buscar tarefas:",r),d.default.error("Erro ao carregar tarefas"),e({isLoading:!1})}},createTask:async t=>{try{let a=await n.lC.create(t);e({tasks:[...r().tasks,a.data]}),d.default.success("Tarefa criada com sucesso!")}catch(e){throw console.error("Erro ao criar tarefa:",e),d.default.error("Erro ao criar tarefa"),e}},updateTask:async(t,a)=>{try{var s;let o=await n.lC.update(t,a),l=r().tasks.map(e=>e._id===t?o.data:e);e({tasks:l}),(null===(s=r().selectedTask)||void 0===s?void 0:s._id)===t&&e({selectedTask:o.data}),d.default.success("Tarefa atualizada!")}catch(e){throw console.error("Erro ao atualizar tarefa:",e),d.default.error("Erro ao atualizar tarefa"),e}},deleteTask:async t=>{try{await n.lC.delete(t);let a=r().tasks.filter(e=>e._id!==t);e({tasks:a,selectedTask:null}),d.default.success("Tarefa deletada!")}catch(e){throw console.error("Erro ao deletar tarefa:",e),d.default.error("Erro ao deletar tarefa"),e}},reorderTasks:async r=>{try{let t=await n.lC.reorder(r);e({tasks:t.data})}catch(e){throw console.error("Erro ao reordenar tarefas:",e),d.default.error("Erro ao reordenar tarefas"),e}},setSelectedTask:r=>{e({selectedTask:r})},uploadAttachment:async(t,a)=>{try{var s;let o=await n.lC.uploadAttachment(t,a),l=r().tasks.map(e=>e._id===t?o.data:e);e({tasks:l}),(null===(s=r().selectedTask)||void 0===s?void 0:s._id)===t&&e({selectedTask:o.data}),d.default.success("Arquivo enviado com sucesso!")}catch(e){throw console.error("Erro ao enviar arquivo:",e),d.default.error("Erro ao enviar arquivo"),e}},deleteAttachment:async(t,a)=>{try{var s;let o=await n.lC.deleteAttachment(t,a),l=r().tasks.map(e=>e._id===t?o.data:e);e({tasks:l}),(null===(s=r().selectedTask)||void 0===s?void 0:s._id)===t&&e({selectedTask:o.data}),d.default.success("Arquivo removido!")}catch(e){throw console.error("Erro ao remover arquivo:",e),d.default.error("Erro ao remover arquivo"),e}}})),m=(0,i.Ue)((e,r)=>({projects:[],selectedProject:null,isLoading:!1,fetchProjects:async()=>{e({isLoading:!0});try{let t=(await n.qx.getAll(!1)).data;if(e({projects:t,isLoading:!1}),!r().selectedProject&&t.length>0){let r=localStorage.getItem("selectedProjectId"),a=null;r&&(a=t.find(e=>e._id===r))&&console.log("\uD83D\uDD04 Restaurando projeto anterior:",a.name),a||(a=t.find(e=>e.isDefault)||t[0],console.log("\uD83D\uDCCB Selecionando projeto padr\xe3o:",null==a?void 0:a.name)),e({selectedProject:a})}}catch(r){console.error("Erro ao buscar projetos:",r),d.default.error("Erro ao carregar projetos"),e({isLoading:!1})}},createProject:async t=>{try{let a=await n.qx.create(t);return e({projects:[...r().projects,a.data]}),d.default.success("Projeto criado com sucesso!"),a.data}catch(e){throw console.error("Erro ao criar projeto:",e),d.default.error("Erro ao criar projeto"),e}},updateProject:async(t,a)=>{try{var s;let o=await n.qx.update(t,a),l=r().projects.map(e=>e._id===t?o.data:e);e({projects:l}),(null===(s=r().selectedProject)||void 0===s?void 0:s._id)===t&&e({selectedProject:o.data}),d.default.success("Projeto atualizado!")}catch(e){throw console.error("Erro ao atualizar projeto:",e),d.default.error("Erro ao atualizar projeto"),e}},deleteProject:async t=>{try{var a;await n.qx.delete(t);let s=r().projects.filter(e=>e._id!==t);e({projects:s}),(null===(a=r().selectedProject)||void 0===a?void 0:a._id)===t&&e({selectedProject:s[0]||null}),d.default.success("Projeto deletado!")}catch(e){throw console.error("Erro ao deletar projeto:",e),d.default.error("Erro ao deletar projeto"),e}},setSelectedProject:r=>{e({selectedProject:r}),r?(localStorage.setItem("selectedProjectId",r._id),console.log("\uD83D\uDCBE Projeto salvo no localStorage:",r.name)):localStorage.removeItem("selectedProjectId")},addMember:async(t,a,s)=>{var o,l,i;try{let l=await n.qx.addMember(t,a,s),i=r().projects.map(e=>e._id===t?l.data:e);e({projects:i}),(null===(o=r().selectedProject)||void 0===o?void 0:o._id)===t&&e({selectedProject:l.data}),d.default.success("Membro adicionado!")}catch(e){throw console.error("Erro ao adicionar membro:",e),d.default.error((null===(i=e.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.message)||"Erro ao adicionar membro"),e}},removeMember:async(t,a)=>{var s,o,l;try{let o=await n.qx.removeMember(t,a),l=r().projects.map(e=>e._id===t?o.data:e);e({projects:l}),(null===(s=r().selectedProject)||void 0===s?void 0:s._id)===t&&e({selectedProject:o.data}),d.default.success("Membro removido!")}catch(e){throw console.error("Erro ao remover membro:",e),d.default.error((null===(l=e.response)||void 0===l?void 0:null===(o=l.data)||void 0===o?void 0:o.message)||"Erro ao remover membro"),e}},updateMemberRole:async(t,a,s)=>{var o,l,i;try{let l=await n.qx.updateMemberRole(t,a,s),i=r().projects.map(e=>e._id===t?l.data:e);e({projects:i}),(null===(o=r().selectedProject)||void 0===o?void 0:o._id)===t&&e({selectedProject:l.data}),d.default.success("Permiss\xe3o atualizada!")}catch(e){throw console.error("Erro ao atualizar permiss\xe3o:",e),d.default.error((null===(i=e.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.message)||"Erro ao atualizar permiss\xe3o"),e}},createDefaultProject:async()=>{try{let t=await n.qx.createDefault();return r().projects.find(e=>e._id===t.data._id)||e({projects:[...r().projects,t.data]}),e({selectedProject:t.data}),t.data}catch(e){throw console.error("Erro ao criar projeto padr\xe3o:",e),e}}})),u=["\uD83D\uDCCB","\uD83D\uDE80","\uD83D\uDCBC","\uD83C\uDFAF","\uD83D\uDCCA","\uD83C\uDFA8","\uD83D\uDCA1","⚡","\uD83D\uDD25","⭐","\uD83C\uDF1F","\uD83C\uDF89"],x=[{name:"Azul",value:"#0ea5e9"},{name:"Verde",value:"#10b981"},{name:"Roxo",value:"#8b5cf6"},{name:"Rosa",value:"#ec4899"},{name:"Laranja",value:"#f97316"},{name:"Vermelho",value:"#ef4444"},{name:"Amarelo",value:"#f59e0b"},{name:"\xcdndigo",value:"#6366f1"}];function h(e){let{onClose:r,project:t}=e,{createProject:o,updateProject:l}=m(),[i,n]=(0,s.useState)((null==t?void 0:t.name)||""),[d,c]=(0,s.useState)((null==t?void 0:t.description)||""),[h,p]=(0,s.useState)((null==t?void 0:t.icon)||"\uD83D\uDCCB"),[g,j]=(0,s.useState)((null==t?void 0:t.color)||"#0ea5e9"),[v,f]=(0,s.useState)(!1),y=async e=>{if(e.preventDefault(),i.trim()){f(!0);try{t?await l(t._id,{name:i,description:d,icon:h,color:g}):await o({name:i,description:d,icon:h,color:g}),r()}catch(e){console.error("Erro ao salvar projeto:",e)}finally{f(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:t?"Editar Projeto":"Novo Projeto"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Projeto *"}),(0,a.jsx)("input",{id:"name",type:"text",required:!0,value:i,onChange:e=>n(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Ex: Desenvolvimento Web"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,a.jsx)("textarea",{id:"description",value:d,onChange:e=>c(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,placeholder:"Descreva o prop\xf3sito do projeto..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xcdcone"}),(0,a.jsx)("div",{className:"grid grid-cols-6 gap-2",children:u.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>p(e),className:"p-3 text-2xl rounded-md border-2 transition-colors ".concat(h===e?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"),children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2",children:x.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>j(e.value),className:"p-3 rounded-md border-2 transition-colors ".concat(g===e.value?"border-gray-900 ring-2 ring-offset-2 ring-gray-900":"border-gray-200"),style:{backgroundColor:e.value},title:e.name,children:g===e.value&&(0,a.jsx)("svg",{className:"w-5 h-5 text-white mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})},e.value))})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o:"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-2xl",style:{backgroundColor:g},children:h}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:i||"Nome do Projeto"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:d||"Descri\xe7\xe3o do projeto"})]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",disabled:v,className:"flex-1 bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Salvando...":t?"Salvar":"Criar Projeto"}),(0,a.jsx)("button",{type:"button",onClick:r,className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300",children:"Cancelar"})]})]})]})})}let p={owner:"Dono",admin:"Administrador",member:"Editor",viewer:"Leitor"},g={admin:"Pode gerenciar membros e todas as tarefas",member:"Pode criar e editar tarefas",viewer:"Pode apenas visualizar tarefas"};function j(e){var r,t,o,l;let{onClose:i}=e,{selectedProject:c,addMember:u,removeMember:x,updateMemberRole:j,deleteProject:v}=m(),[f,y]=(0,s.useState)([]),[b,N]=(0,s.useState)(""),[w,k]=(0,s.useState)("member"),[C,D]=(0,s.useState)(!1),[E,S]=(0,s.useState)(!1),[P,_]=(0,s.useState)("");(0,s.useEffect)(()=>{L()},[]);let L=async()=>{try{let e=await n.iJ.getUsers();y(e.data)}catch(e){console.error("Erro ao buscar usu\xe1rios:",e)}},M=async()=>{if(b.trim()&&c){S(!0),_("");try{let e=await n.iJ.getUserByEmail(b.trim());if(!e.data.found){_("Nenhum usu\xe1rio encontrado com este email. A pessoa precisa criar uma conta primeiro."),S(!1);return}let r=e.data.user;if(c.members.some(e=>e.user.id===r.id)){_("Este usu\xe1rio j\xe1 \xe9 membro do projeto."),S(!1);return}await u(c._id,r.id,w),N(""),k("member"),_(""),d.default.success("".concat(r.name," foi adicionado ao projeto!"))}catch(r){var e;console.error("Erro ao adicionar membro:",r),(null===(e=r.response)||void 0===e?void 0:e.status)===404?_("Nenhum usu\xe1rio encontrado com este email. A pessoa precisa criar uma conta primeiro."):_("Erro ao buscar usu\xe1rio. Tente novamente.")}finally{S(!1)}}},A=async e=>{if(c&&confirm("Tem certeza que deseja remover este membro?"))try{await x(c._id,e)}catch(e){console.error("Erro ao remover membro:",e)}},T=async(e,r)=>{if(c)try{await j(c._id,e,r)}catch(e){console.error("Erro ao atualizar permiss\xe3o:",e)}},z=async()=>{if(c&&confirm('Tem certeza que deseja deletar o projeto "'.concat(c.name,'"? Todas as tarefas ser\xe3o removidas permanentemente!')))try{await v(c._id),i(),d.default.success("Projeto deletado com sucesso")}catch(e){console.error("Erro ao deletar projeto:",e)}};if(!c)return null;f.filter(e=>!c.members.some(r=>{var t;return(null===(t=r.user)||void 0===t?void 0:t.id)===e.id}));let B=null;try{let e=localStorage.getItem("user");e&&(B=JSON.parse(e).id)}catch(e){console.error("Erro ao obter user do localStorage:",e)}let F=String((null===(r=c.owner)||void 0===r?void 0:r.id)||(null===(t=c.owner)||void 0===t?void 0:t.id)||c.owner)===String(B),q=c.members.some(e=>{var r,t;let a=(null===(r=e.user)||void 0===r?void 0:r.id)||(null===(t=e.user)||void 0===t?void 0:t.id);return"owner"===e.role&&String(a)===String(B)}),I=F||q,R=c.members.some(e=>{var r,t;let a=(null===(r=e.user)||void 0===r?void 0:r.id)||(null===(t=e.user)||void 0===t?void 0:t.id);return"admin"===e.role&&String(a)===String(B)});return console.log("Debug ProjectSettings:",{currentUserId:B,ownerId:(null===(o=c.owner)||void 0===o?void 0:o.id)||(null===(l=c.owner)||void 0===l?void 0:l.id),isOwner:I,isAdmin:R,canManageMembers:!0,members:c.members}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-2xl",style:{backgroundColor:c.color},children:c.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:c.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:c.description})]})]}),(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"A\xe7\xf5es do Projeto"}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>D(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Editar Projeto"}),I&&(0,a.jsx)("button",{onClick:z,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Deletar Projeto"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:["Membros (",c.members.length,")"]}),(0,a.jsx)("div",{className:"space-y-2 mb-4",children:c.members.map(e=>{var r,t;return e.user&&e.user.name?(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary-500 text-white flex items-center justify-center",children:(null===(t=e.user.name)||void 0===t?void 0:null===(r=t.charAt(0))||void 0===r?void 0:r.toUpperCase())||"?"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.user.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.user.email})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:"owner"===e.role?(0,a.jsx)("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium",children:p[e.role]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("select",{value:e.role,onChange:r=>T(e.user.id,r.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",disabled:!1,title:g[e.role]||"",children:[(0,a.jsx)("option",{value:"admin",children:"⚙️ Administrador"}),(0,a.jsx)("option",{value:"member",children:"\uD83D\uDCDD Editor"}),(0,a.jsx)("option",{value:"viewer",children:"\uD83D\uDC41️ Leitor"})]}),(0,a.jsx)("button",{onClick:()=>A(e.user.id),className:"text-red-600 hover:text-red-800",title:"Remover membro",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]},e.user.id||e._id):null})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDD17 Compartilhar Projeto"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"Digite o email da pessoa que deseja adicionar. Ela precisar\xe1 ter uma conta no sistema."}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"email",value:b,onChange:e=>{N(e.target.value),_("")},onKeyPress:e=>{"Enter"===e.key&&M()},placeholder:"email@exemplo.com",className:"flex-1 border border-gray-300 rounded-md p-2 text-sm"}),(0,a.jsxs)("select",{value:w,onChange:e=>k(e.target.value),className:"border border-gray-300 rounded-md p-2 text-sm",title:g[w],children:[(0,a.jsx)("option",{value:"member",children:"\uD83D\uDCDD Editor"}),(0,a.jsx)("option",{value:"admin",children:"⚙️ Administrador"}),(0,a.jsx)("option",{value:"viewer",children:"\uD83D\uDC41️ Leitor"})]}),(0,a.jsx)("button",{onClick:M,disabled:!b.trim()||E,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-1",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,a.jsx)("span",{children:"Buscando..."})]}):(0,a.jsx)("span",{children:"Adicionar"})})]}),P&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-md text-sm",children:P}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 text-xs",children:[(0,a.jsx)("p",{className:"font-semibold text-blue-900 mb-2",children:"N\xedveis de Permiss\xe3o:"}),(0,a.jsxs)("ul",{className:"space-y-1 text-blue-800",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDCDD Editor:"})," Pode criar e editar tarefas"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"⚙️ Administrador:"})," Pode gerenciar membros e todas as tarefas"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDC41️ Leitor:"})," Pode apenas visualizar tarefas (sem edi\xe7\xe3o)"]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4 text-sm text-gray-500",children:[(0,a.jsxs)("p",{children:["Projeto criado em ",new Date(c.createdAt).toLocaleDateString("pt-BR")]}),(0,a.jsx)("p",{className:"mt-1",children:(0,a.jsx)("strong",{children:"N\xedveis de Permiss\xe3o:"})}),(0,a.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDC51 Dono:"})," Controle total do projeto (criar, editar, deletar, gerenciar membros)"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"⚙️ Administrador:"})," Pode gerenciar membros e todas as tarefas"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDCDD Editor:"})," Pode criar e editar tarefas do projeto"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"\uD83D\uDC41️ Leitor:"})," Pode apenas visualizar tarefas (sem permiss\xe3o de edi\xe7\xe3o)"]})]}),(0,a.jsxs)("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800",children:[(0,a.jsx)("strong",{children:"\uD83D\uDCA1 Dica:"})," Para compartilhar este projeto, adicione pessoas usando o email delas. Elas precisam ter uma conta criada no sistema."]})]})]})]})}),C&&(0,a.jsx)(h,{onClose:()=>D(!1),project:c})]})}function v(){let{user:e,logout:r}=(0,l.t)(),{selectedProject:t}=m(),i=(0,o.useRouter)(),[n,d]=(0,s.useState)(!1);return(0,a.jsxs)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("h1",{className:"text-2xl font-bold text-primary-600",children:"Trello Nippon"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[t&&(0,a.jsxs)("button",{onClick:()=>d(!0),className:"text-sm text-gray-600 hover:text-gray-900 font-medium flex items-center space-x-1",children:[(0,a.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,a.jsx)("span",{children:"Configura\xe7\xf5es"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center text-white font-semibold",children:null==e?void 0:e.name.charAt(0).toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:null==e?void 0:e.name})]}),(0,a.jsx)("button",{onClick:()=>{r(),i.push("/login")},className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"Sair"})]})]})}),n&&(0,a.jsx)(j,{onClose:()=>d(!1)})]})}var f=t(9684),y=t(7369),b=t(7344),N=t(2836);let w={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"},k={low:"Baixa",medium:"M\xe9dia",high:"Alta"};function C(e){let{task:r}=e,{setSelectedTask:t}=c(),{attributes:s,listeners:o,setNodeRef:l,transform:i}=(0,f.O1)({id:r._id}),n=i?{transform:"translate3d(".concat(i.x,"px, ").concat(i.y,"px, 0)")}:void 0;return(0,a.jsxs)("div",{ref:l,style:n,...o,...s,onClick:()=>{t(r)},className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow cursor-pointer",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:r.title}),r.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:r.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(w[r.priority]),children:k[r.priority]}),r.dueDate&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:(0,b.WU)(new Date(r.dueDate),"dd/MM/yyyy",{locale:N.F})})]}),r.assignedTo.length>0&&(0,a.jsxs)("div",{className:"flex items-center mt-3 space-x-1",children:[r.assignedTo.slice(0,3).map(e=>(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary-500 text-white text-xs flex items-center justify-center",title:e.name,children:e.name.charAt(0).toUpperCase()},e.id)),r.assignedTo.length>3&&(0,a.jsxs)("div",{className:"w-6 h-6 rounded-full bg-gray-300 text-gray-700 text-xs flex items-center justify-center",children:["+",r.assignedTo.length-3]})]}),r.attachments.length>0&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500 flex items-center",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),r.attachments.length," anexo",r.attachments.length>1?"s":""]})]})}function D(e){let{id:r,title:t,color:s,tasks:o}=e,{setNodeRef:l}=(0,f.Zj)({id:r});return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"".concat(s," rounded-t-lg p-3 border-b-2 border-gray-300"),children:(0,a.jsxs)("h3",{className:"font-semibold text-gray-800 flex items-center justify-between",children:[t,(0,a.jsx)("span",{className:"text-xs bg-white px-2 py-1 rounded-full",children:o.length})]})}),(0,a.jsxs)("div",{ref:l,className:"flex-1 bg-gray-50 rounded-b-lg p-3 min-h-[500px] space-y-3 overflow-y-auto scrollbar-hide",children:[(0,a.jsx)(y.Fo,{items:o.map(e=>e._id),strategy:y.qw,children:o.map(e=>(0,a.jsx)(C,{task:e},e._id))}),0===o.length&&(0,a.jsx)("div",{className:"text-center text-gray-400 text-sm mt-8",children:"Arraste tarefas aqui"})]})]})}let E=[{id:"todo",title:"A Fazer",color:"bg-gray-100"},{id:"in_progress",title:"Em Progresso",color:"bg-blue-100"},{id:"review",title:"Em Revis\xe3o",color:"bg-yellow-100"},{id:"done",title:"Conclu\xeddo",color:"bg-green-100"}];function S(){let{tasks:e,fetchTasks:r,reorderTasks:t}=c(),{selectedProject:o}=m(),[l,i]=(0,s.useState)(null),n=(0,f.Dy)((0,f.VT)(f.we,{activationConstraint:{distance:8}}));return(0,s.useEffect)(()=>{o&&r(o._id)},[o,r]),(0,a.jsxs)(f.LB,{sensors:n,onDragStart:r=>{i(e.find(e=>e._id===r.active.id)||null)},onDragEnd:r=>{let{active:a,over:s}=r;if(i(null),!s)return;let o=a.id,l=s.id,n=e.find(e=>e._id===o);if(!n||n.status===l)return;let d=e.filter(e=>e.status===l&&e._id!==o);t([...e.filter(e=>e.status!==l&&e._id!==o),...d,{...n,status:l}].map((e,r)=>({id:e._id,status:e._id===o?l:e.status,order:r})))},children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-6",children:E.map(r=>(0,a.jsx)(D,{id:r.id,title:r.title,color:r.color,tasks:e.filter(e=>e.status===r.id)},r.id))}),(0,a.jsx)(f.y9,{children:l?(0,a.jsx)("div",{className:"opacity-80",children:(0,a.jsx)(C,{task:l})}):null})]})}var P=t(569);t(9865);var _=t(2339);function L(){let{tasks:e,fetchTasks:r,setSelectedTask:t}=c(),{selectedProject:o}=m(),[l,i]=(0,s.useState)(new Date),[n,d]=(0,s.useState)([]);(0,s.useEffect)(()=>{o&&r(o._id)},[o,r]),(0,s.useEffect)(()=>{d(e.filter(e=>e.dueDate&&(0,_.K)(new Date(e.dueDate),l)))},[l,e]);let u={low:"border-green-500",medium:"border-yellow-500",high:"border-red-500"},x={todo:"A Fazer",in_progress:"Em Progresso",review:"Em Revis\xe3o",done:"Conclu\xeddo"};return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Calend\xe1rio de Tarefas"}),(0,a.jsx)(P.ZP,{onChange:e=>i(e),value:l,locale:"pt-BR",tileContent:r=>{let{date:t,view:s}=r;return"month"===s&&e.filter(e=>e.dueDate&&(0,_.K)(new Date(e.dueDate),t)).length>0?(0,a.jsx)("div",{className:"flex justify-center mt-1",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-primary-500 rounded-full"})}):null},className:"w-full"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Tarefas para ",(0,b.WU)(l,"dd 'de' MMMM 'de' yyyy",{locale:N.F})]}),0===n.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Nenhuma tarefa agendada para esta data"}):(0,a.jsx)("div",{className:"space-y-3",children:n.map(e=>(0,a.jsx)("div",{onClick:()=>t(e),className:"border-l-4 ".concat(u[e.priority]," bg-gray-50 p-4 rounded-r-lg cursor-pointer hover:bg-gray-100 transition-colors"),children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.title}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center mt-2 space-x-3",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Status: ",x[e.status]]}),e.assignedTo.length>0&&(0,a.jsx)("div",{className:"flex items-center space-x-1",children:e.assignedTo.slice(0,2).map(e=>(0,a.jsx)("div",{className:"w-5 h-5 rounded-full bg-primary-500 text-white text-xs flex items-center justify-center",title:e.name,children:e.name.charAt(0).toUpperCase()},e.id))})]})]})})},e._id))})]})]})})}var M=t(5020),A=t(2601);function T(e){let{task:r}=e,{uploadAttachment:t,deleteAttachment:o}=c(),[l,i]=(0,s.useState)(!1),[n,m]=(0,s.useState)(null),u=async e=>{if(0===e.length)return;let a=e[0];if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp","application/pdf"].includes(a.type)){d.default.error("Tipo de arquivo n\xe3o permitido. Apenas imagens e PDFs s\xe3o aceitos.");return}if(a.size>10485760){d.default.error("Arquivo muito grande. Tamanho m\xe1ximo: 10MB");return}i(!0);try{await t(r._id,a)}catch(e){console.error("Erro ao fazer upload:",e)}finally{i(!1)}},{getRootProps:x,getInputProps:h,isDragActive:p}=(0,M.uI)({onDrop:u,accept:{"image/*":[".jpeg",".jpg",".png",".gif",".webp"],"application/pdf":[".pdf"]},maxFiles:1}),g=async e=>{if(confirm("Tem certeza que deseja remover este anexo?"))try{await o(r._id,e)}catch(e){console.error("Erro ao deletar anexo:",e)}},j=e=>{let r=A.env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api",t="".concat(r.replace("/api",""),"/").concat(e.path);e.mimetype.startsWith("image/")?m(t):"application/pdf"===e.mimetype&&window.open(t,"_blank")},v=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(2)+" KB":(e/1048576).toFixed(2)+" MB";return(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Anexos"}),(0,a.jsxs)("div",{...x(),className:"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ".concat(p?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-primary-400"," ").concat(l?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)("input",{...h(),disabled:l}),l?(0,a.jsx)("p",{className:"text-gray-600",children:"Enviando arquivo..."}):p?(0,a.jsx)("p",{className:"text-primary-600",children:"Solte o arquivo aqui..."}):(0,a.jsxs)("div",{children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Arraste e solte um arquivo aqui, ou clique para selecionar"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Imagens (JPEG, PNG, GIF, WebP) ou PDFs at\xe9 10MB"})]})]}),r.attachments.length>0&&(0,a.jsx)("div",{className:"mt-4 space-y-2",children:r.attachments.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3 hover:bg-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.mimetype.startsWith("image/")?(0,a.jsx)("svg",{className:"w-8 h-8 text-blue-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}):(0,a.jsx)("svg",{className:"w-8 h-8 text-red-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.originalName}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[v(e.size)," • ",e.uploadedBy.name]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 ml-2",children:[(0,a.jsx)("button",{onClick:()=>j(e),className:"text-primary-600 hover:text-primary-800 text-sm font-medium",children:"Ver"}),(0,a.jsx)("button",{onClick:()=>g(e._id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remover"})]})]},e._id))}),n&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:()=>m(null),children:(0,a.jsxs)("div",{className:"relative max-w-4xl max-h-full",children:[(0,a.jsx)("button",{onClick:()=>m(null),className:"absolute -top-10 right-0 text-white hover:text-gray-300",children:(0,a.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("img",{src:n,alt:"Preview",className:"max-w-full max-h-[80vh] object-contain"})]})})]})}let z=[{value:"todo",label:"A Fazer"},{value:"in_progress",label:"Em Progresso"},{value:"review",label:"Em Revis\xe3o"},{value:"done",label:"Conclu\xeddo"}],B=[{value:"low",label:"Baixa"},{value:"medium",label:"M\xe9dia"},{value:"high",label:"Alta"}];function F(){var e,r;let{selectedTask:t,setSelectedTask:o,updateTask:l,deleteTask:i}=c(),[m,u]=(0,s.useState)([]),[x,h]=(0,s.useState)(""),[p,g]=(0,s.useState)([]),[j,v]=(0,s.useState)(!1),[f,y]=(0,s.useState)(t);(0,s.useEffect)(()=>{t&&(y(t),w(),k())},[t]);let w=async()=>{if(t)try{let e=await n.HF.getByTask(t._id);u(e.data)}catch(e){console.error("Erro ao buscar coment\xe1rios:",e)}},k=async()=>{try{let e=await n.iJ.getUsers();g(e.data)}catch(e){console.error("Erro ao buscar usu\xe1rios:",e)}},C=async e=>{if(e.preventDefault(),x.trim()&&t)try{let e=await n.HF.create({taskId:t._id,text:x});u([e.data,...m]),h("")}catch(e){console.error("Erro ao adicionar coment\xe1rio:",e)}},D=async e=>{try{await n.HF.delete(e),u(m.filter(r=>r._id!==e)),d.default.success("Coment\xe1rio removido!")}catch(e){console.error("Erro ao deletar coment\xe1rio:",e)}},E=async()=>{if(t&&f)try{await l(t._id,{title:f.title,description:f.description,status:f.status,priority:f.priority,dueDate:f.dueDate,assignedTo:f.assignedTo.map(e=>e.id)}),v(!1)}catch(e){console.error("Erro ao salvar tarefa:",e)}},S=async()=>{if(t&&confirm("Tem certeza que deseja deletar esta tarefa?"))try{await i(t._id),o(null)}catch(e){console.error("Erro ao deletar tarefa:",e)}},P=e=>{if(!f)return;let r=f.assignedTo.some(r=>r.id===e.id)?f.assignedTo.filter(r=>r.id!==e.id):[...f.assignedTo,e];y({...f,assignedTo:r})};return t&&f?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-start",children:[(0,a.jsx)("div",{className:"flex-1",children:j?(0,a.jsx)("input",{type:"text",value:f.title,onChange:e=>y({...f,title:e.target.value}),className:"text-2xl font-bold w-full border-b-2 border-primary-500 focus:outline-none"}):(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:t.title})}),(0,a.jsx)("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-gray-600 ml-4",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:E,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Salvar"}),(0,a.jsx)("button",{onClick:()=>{v(!1),y(t)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancelar"})]}):(0,a.jsx)("button",{onClick:()=>v(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Editar"}),(0,a.jsx)("button",{onClick:S,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Deletar"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Descri\xe7\xe3o"}),j?(0,a.jsx)("textarea",{value:f.description,onChange:e=>y({...f,description:e.target.value}),className:"w-full border border-gray-300 rounded-md p-3 min-h-[100px] focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Adicione uma descri\xe7\xe3o..."}):(0,a.jsx)("p",{className:"text-gray-600",children:t.description||"Sem descri\xe7\xe3o"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Status"}),j?(0,a.jsx)("select",{value:f.status,onChange:e=>y({...f,status:e.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:z.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,a.jsx)("p",{className:"text-gray-600",children:null===(e=z.find(e=>e.value===t.status))||void 0===e?void 0:e.label})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Prioridade"}),j?(0,a.jsx)("select",{value:f.priority,onChange:e=>y({...f,priority:e.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:B.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,a.jsx)("p",{className:"text-gray-600",children:null===(r=B.find(e=>e.value===t.priority))||void 0===r?void 0:r.label})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Data de Vencimento"}),j?(0,a.jsx)("input",{type:"date",value:f.dueDate?f.dueDate.split("T")[0]:"",onChange:e=>y({...f,dueDate:e.target.value||null}),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500"}):(0,a.jsx)("p",{className:"text-gray-600",children:t.dueDate?(0,b.WU)(new Date(t.dueDate),"dd 'de' MMMM 'de' yyyy",{locale:N.F}):"Sem data de vencimento"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Atribu\xeddo a"}),j?(0,a.jsx)("div",{className:"space-y-2",children:p.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:f.assignedTo.some(r=>r.id===e.id),onChange:()=>P(e),className:"rounded text-primary-600 focus:ring-primary-500"}),(0,a.jsx)("span",{className:"text-gray-700",children:e.name})]},e.id))}):(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:t.assignedTo.length>0?t.assignedTo.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-primary-100 text-primary-800 px-3 py-1 rounded-full",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary-500 text-white text-xs flex items-center justify-center",children:e.name.charAt(0).toUpperCase()}),(0,a.jsx)("span",{className:"text-sm",children:e.name})]},e.id)):(0,a.jsx)("p",{className:"text-gray-500",children:"Nenhum usu\xe1rio atribu\xeddo"})})]}),(0,a.jsx)(T,{task:t}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Coment\xe1rios"}),(0,a.jsxs)("form",{onSubmit:C,className:"mb-4",children:[(0,a.jsx)("textarea",{value:x,onChange:e=>h(e.target.value),className:"w-full border border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Adicione um coment\xe1rio...",rows:3}),(0,a.jsx)("button",{type:"submit",disabled:!x.trim(),className:"mt-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Comentar"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[m.map(e=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-500 text-white text-sm flex items-center justify-center",children:e.user.name.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:e.user.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(0,b.WU)(new Date(e.createdAt),"dd/MM/yyyy '\xe0s' HH:mm",{locale:N.F})})]})]}),(0,a.jsx)("button",{onClick:()=>D(e._id),className:"text-red-500 hover:text-red-700 text-sm",children:"Remover"})]}),(0,a.jsx)("p",{className:"mt-2 text-gray-700",children:e.text})]},e._id)),0===m.length&&(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhum coment\xe1rio ainda"})]})]})]})]})}):null}function q(e){let{onClose:r}=e,{createTask:t}=c(),{selectedProject:o}=m(),[l,i]=(0,s.useState)(""),[n,d]=(0,s.useState)(""),[u,x]=(0,s.useState)("medium"),[h,p]=(0,s.useState)(""),[g,j]=(0,s.useState)(!1),v=async e=>{if(e.preventDefault(),l.trim()){if(!o){alert("Selecione um projeto primeiro");return}j(!0);try{await t({title:l,description:n,priority:u,dueDate:h||null,status:"todo",projectId:o._id}),r()}catch(e){console.error("Erro ao criar tarefa:",e)}finally{j(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Nova Tarefa"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo *"}),(0,a.jsx)("input",{id:"title",type:"text",required:!0,value:l,onChange:e=>i(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Digite o t\xedtulo da tarefa"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,a.jsx)("textarea",{id:"description",value:n,onChange:e=>d(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,placeholder:"Descreva a tarefa..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridade"}),(0,a.jsxs)("select",{id:"priority",value:u,onChange:e=>x(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"low",children:"Baixa"}),(0,a.jsx)("option",{value:"medium",children:"M\xe9dia"}),(0,a.jsx)("option",{value:"high",children:"Alta"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Vencimento"}),(0,a.jsx)("input",{id:"dueDate",type:"date",value:h,onChange:e=>p(e.target.value),className:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",disabled:g,className:"flex-1 bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Criando...":"Criar Tarefa"}),(0,a.jsx)("button",{type:"button",onClick:r,className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300",children:"Cancelar"})]})]})]})})}function I(){let{projects:e,selectedProject:r,setSelectedProject:t,fetchProjects:o}=m(),[l,i]=(0,s.useState)(!1),[n,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{o()},[o]);let c=e=>{t(e),i(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>i(!l),className:"flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:(null==r?void 0:r.icon)||"\uD83D\uDCCB"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:(null==r?void 0:r.name)||"Selecione um projeto"}),r&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[r.members.length," membro",1!==r.members.length?"s":""]})]}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-500 transition-transform ".concat(l?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),(0,a.jsx)("div",{className:"absolute top-full left-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:(0,a.jsxs)("div",{className:"p-2 max-h-96 overflow-y-auto",children:[(0,a.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase",children:"Seus Projetos"}),0===e.length?(0,a.jsx)("div",{className:"px-3 py-6 text-center text-gray-500 text-sm",children:"Nenhum projeto encontrado"}):e.map(e=>(0,a.jsxs)("button",{onClick:()=>c(e),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-md hover:bg-gray-100 transition-colors ".concat((null==r?void 0:r._id)===e._id?"bg-primary-50":""),children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.description})]}),(null==r?void 0:r._id)===e._id&&(0,a.jsx)("svg",{className:"w-5 h-5 text-primary-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},e._id)),(0,a.jsx)("div",{className:"border-t border-gray-200 mt-2 pt-2",children:(0,a.jsxs)("button",{onClick:()=>{d(!0),i(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-primary-600 hover:bg-primary-50 rounded-md transition-colors",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsx)("span",{className:"font-medium",children:"Novo Projeto"})]})})]})})]})]}),n&&(0,a.jsx)(h,{onClose:()=>d(!1)})]})}function R(){let{user:e}=(0,l.t)(),[r,t]=(0,s.useState)(!1),[o,i]=(0,s.useState)(!1),c=async()=>{i(!0);try{await n.iJ.resendVerification(),d.default.success("Email de verifica\xe7\xe3o reenviado! Verifique sua caixa de entrada.",{duration:5e3})}catch(t){var e,r;d.default.error((null===(r=t.response)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:e.message)||"Erro ao reenviar email")}finally{i(!1)}};return!e||e.emailVerified||r?null:(0,a.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,a.jsx)("strong",{children:"⚠️ Email n\xe3o verificado."})," Verifique seu email para ativar sua conta e ter acesso completo."]}),(0,a.jsxs)("div",{className:"mt-2 flex space-x-3",children:[(0,a.jsx)("button",{onClick:c,disabled:o,className:"text-sm font-medium text-yellow-800 underline hover:text-yellow-900 disabled:opacity-50",children:o?"Reenviando...":"Reenviar email de verifica\xe7\xe3o"}),(0,a.jsx)("button",{onClick:()=>t(!0),className:"text-sm font-medium text-yellow-600 hover:text-yellow-700",children:"Dispensar"})]})]})]})})}function W(){let e=(0,o.useRouter)(),{isAuthenticated:r,loadUser:t}=(0,l.t)(),{selectedTask:i}=c(),{selectedProject:n,fetchProjects:d,createDefaultProject:u}=m(),[x,h]=(0,s.useState)("kanban"),[p,g]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{t()},[t]),(0,s.useEffect)(()=>{r||e.push("/login")},[r,e]),(0,s.useEffect)(()=>{(async()=>{if(r){await d();let e=await d();(void 0===e||Array.isArray(e)&&0===e.length)&&await u()}})()},[r,d,u]),r)?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)(v,{}),(0,a.jsx)(R,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Minhas Tarefas"}),(0,a.jsx)(I,{})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-1 flex space-x-1",children:[(0,a.jsxs)("button",{onClick:()=>h("kanban"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("kanban"===x?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),"Kanban"]}),(0,a.jsxs)("button",{onClick:()=>h("calendar"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("calendar"===x?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Calend\xe1rio"]})]}),(0,a.jsxs)("button",{onClick:()=>g(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-primary-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsx)("span",{children:"Nova Tarefa"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm",children:"kanban"===x?(0,a.jsx)(S,{}):(0,a.jsx)(L,{})})]}),i&&(0,a.jsx)(F,{}),p&&(0,a.jsx)(q,{onClose:()=>g(!1)})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}},8222:function(e,r,t){"use strict";t.d(r,{HF:function(){return d},iJ:function(){return l},lC:function(){return n},qx:function(){return i}});var a=t(4829);let s=t(2601).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api",o=a.Z.create({baseURL:s,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let r=localStorage.getItem("token");return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,e=>{var r;return(null===(r=e.response)||void 0===r?void 0:r.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let l={register:e=>o.post("/auth/register",e),login:e=>o.post("/auth/login",e),getMe:()=>o.get("/auth/me"),getUsers:()=>o.get("/auth/users"),getUserByEmail:e=>o.get("/auth/users/by-email/".concat(e)),verifyEmail:e=>o.get("/auth/verify-email?token=".concat(e)),resendVerification:()=>o.post("/auth/resend-verification")},i={getAll:e=>o.get("/projects",{params:{includeArchived:e}}),getById:e=>o.get("/projects/".concat(e)),create:e=>o.post("/projects",e),update:(e,r)=>o.put("/projects/".concat(e),r),delete:e=>o.delete("/projects/".concat(e)),addMember:(e,r,t)=>o.post("/projects/".concat(e,"/members"),{userId:r,role:t}),removeMember:(e,r)=>o.delete("/projects/".concat(e,"/members/").concat(r)),updateMemberRole:(e,r,t)=>o.put("/projects/".concat(e,"/members/").concat(r),{role:t}),createDefault:()=>o.post("/projects/create-default")},n={getAll:e=>o.get("/tasks",{params:{projectId:e}}),getById:e=>o.get("/tasks/".concat(e)),create:e=>o.post("/tasks",e),update:(e,r)=>o.put("/tasks/".concat(e),r),delete:e=>o.delete("/tasks/".concat(e)),reorder:e=>o.post("/tasks/reorder",{tasks:e}),uploadAttachment:(e,r)=>{let t=new FormData;return t.append("file",r),o.post("/tasks/".concat(e,"/attachments"),t,{headers:{"Content-Type":"multipart/form-data"}})},deleteAttachment:(e,r)=>o.delete("/tasks/".concat(e,"/attachments/").concat(r)),downloadAttachment:(e,r)=>"".concat(s,"/tasks/").concat(e,"/attachments/").concat(r,"/download")},d={getByTask:e=>o.get("/comments/task/".concat(e)),create:e=>o.post("/comments",e),update:(e,r)=>o.put("/comments/".concat(e),r),delete:e=>o.delete("/comments/".concat(e))}},8958:function(e,r,t){"use strict";t.d(r,{t:function(){return l}});var a=t(4660),s=t(8222),o=t(5925);let l=(0,a.Ue)(e=>({user:null,token:null,isAuthenticated:!1,login:async(r,t)=>{try{let{token:a,user:l}=(await s.iJ.login({email:r,password:t})).data;localStorage.setItem("token",a),localStorage.setItem("user",JSON.stringify(l)),e({user:l,token:a,isAuthenticated:!0}),o.default.success("Login realizado com sucesso!")}catch(r){var a,l;let e=(null===(l=r.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.message)||"Erro ao fazer login";throw o.default.error(e),r}},register:async(r,t,a)=>{try{let{token:l,user:i}=(await s.iJ.register({name:r,email:t,password:a})).data;localStorage.setItem("token",l),localStorage.setItem("user",JSON.stringify(i)),e({user:i,token:l,isAuthenticated:!0}),o.default.success("Conta criada com sucesso!")}catch(r){var l,i;let e=(null===(i=r.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.message)||"Erro ao criar conta";throw o.default.error(e),r}},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),e({user:null,token:null,isAuthenticated:!1}),o.default.success("Logout realizado com sucesso!")},loadUser:async()=>{let r=localStorage.getItem("token"),t=localStorage.getItem("user");if(r&&t)try{let a=JSON.parse(t);e({user:a,token:r,isAuthenticated:!0})}catch(e){console.error("Erro ao carregar usu\xe1rio:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}}}))}},function(e){e.O(0,[600,810,557,971,938,744],function(){return e(e.s=1386)}),_N_E=e.O()}]);